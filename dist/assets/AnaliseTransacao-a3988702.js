import{r as l,j as e,S as N,P as y,b as o,L as v}from"./index-a2563983.js";import{s as w}from"./CircleNotch.es-295869f9.js";import{f as C}from"./MagnifyingGlass.es-c5020417.js";import{u as T}from"./useApiClient-0bf86fc1.js";import{C as i,a as c,b as x,c as m}from"./cards-fd94db0b.js";import{N as A}from"./Notification-120d2688.js";import"./Info.es-1c589a57.js";import"./Warning.es-51a03ee6.js";import"./XCircle.es-fcbde856.js";const V=()=>{const u=T(),[r,b]=l.useState([]),[n,h]=l.useState(!1),[d,t]=l.useState(null),p=async()=>{try{h(!0),console.log("🔍 Buscando dados de fatvarejo...");const s=await u.financial.fatvarejo();let a=[];s!=null&&s.success&&(s!=null&&s.data)?a=Array.isArray(s.data)?s.data:[]:Array.isArray(s)&&(a=s),console.log("📊 Dados recebidos de fatvarejo:",a),b(a),a.length===0&&(t({type:"info",message:"Nenhuma transação encontrada"}),setTimeout(()=>t(null),3e3))}catch(s){console.error("❌ Erro ao buscar dados de fatvarejo:",s),t({type:"error",message:"Erro ao carregar dados de transações"}),setTimeout(()=>t(null),3e3)}finally{h(!1)}};l.useEffect(()=>{p()},[]);const j=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s||0),g=r.length,f=r.reduce((s,a)=>s+(parseFloat(a.valor_com_desconto)||0),0);return e.jsxs("div",{className:"w-full",children:[e.jsx(N,{title:"Análise de Transação - Crosby",description:"Análise detalhada das transações do varejo"}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx(y,{title:"Análise de Transação",subtitle:"Análise detalhada das transações do varejo",icon:o,iconColor:"text-blue-600"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs(i,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(c,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:18,className:"text-blue-600"}),e.jsx(x,{className:"text-sm font-bold text-blue-700",children:"Total de Transações"})]})}),e.jsxs(m,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-blue-600 mb-0.5",children:g}),e.jsx(CardDescription,{className:"text-xs text-gray-500",children:"Transações encontradas"})]})]}),e.jsxs(i,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(c,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:18,className:"text-green-600"}),e.jsx(x,{className:"text-sm font-bold text-green-700",children:"Valor Total"})]})}),e.jsxs(m,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-green-600 mb-0.5",children:j(f)}),e.jsx(CardDescription,{className:"text-xs text-gray-500",children:"Valor total com desconto"})]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:p,disabled:n,className:"flex items-center gap-2 bg-[#000638] text-white px-4 py-2 rounded-lg hover:bg-[#fe0000] disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors",children:n?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:16,className:"animate-spin"}),"Carregando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{size:16}),"Atualizar Dados"]})})}),e.jsxs(i,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(c,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:18,className:"text-[#000638]"}),e.jsx(x,{className:"text-sm font-bold text-[#000638]",children:"Lista de Transações"})]})}),e.jsxs(m,{className:"pt-0 px-4 pb-4",children:[e.jsx(CardDescription,{className:"text-xs text-gray-500 mb-4",children:"Detalhes de todas as transações encontradas"}),n?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(v,{size:"md",text:"Carregando transações..."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Número da Transação"}),e.jsx("th",{className:"px-4 py-3",children:"Valor com Desconto"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:2,className:"px-4 py-8 text-center text-gray-500",children:"Nenhuma transação encontrada"})}):r.map((s,a)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-blue-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded",children:s.nr_transacao||"N/A"})}),e.jsx("td",{className:"px-4 py-3 font-medium text-green-600",children:j(s.valor_com_desconto)})]},a))})]})})]})]}),d&&e.jsx(A,{type:d.type,message:d.message,onClose:()=>t(null)})]})]})};export{V as default};
