import{r as n,h as ss,j as e,S as ts,P as as,a0 as Ee,p as Be,b as le,q as Ce,m as ne}from"./index-a2563983.js";import{L as os}from"./LoadingSpinner-2a48c1ee.js";import{C as v,c as y,a as N,b as w,d as _}from"./cards-fd94db0b.js";import{F as rs}from"./FiltroEmpresa-724027b5.js";import{u as ls}from"./useApiClient-0bf86fc1.js";import{c as T}from"./ArrowDown.es-b2258871.js";import{s as S}from"./ArrowUp.es-3ccbaccd.js";import{s as ns}from"./Download.es-dafa4844.js";import{s as cs}from"./Funnel.es-cd3339ac.js";import{s as Ae}from"./Percent.es-d80b2e48.js";import{R as D,b as E,X as B,Y as C,T as k,L as A,P as Le,a as $e,C as Ke,B as M,c as b}from"./PieChart-2e5dc4ea.js";import{L as Me,a as z}from"./LineChart-570f6699.js";const ds=new Map([["bold",n.createElement(n.Fragment,null,n.createElement("path",{d:"M120.49,167.51a12,12,0,0,1,0,17l-32,32a12,12,0,0,1-17,0l-32-32a12,12,0,1,1,17-17L68,179V48a12,12,0,0,1,24,0V179l11.51-11.52A12,12,0,0,1,120.49,167.51Zm96-96-32-32a12,12,0,0,0-17,0l-32,32a12,12,0,0,0,17,17L164,77V208a12,12,0,0,0,24,0V77l11.51,11.52a12,12,0,0,0,17-17Z"}))],["duotone",n.createElement(n.Fragment,null,n.createElement("path",{d:"M176,48V208H80V48Z",opacity:"0.2"}),n.createElement("path",{d:"M117.66,170.34a8,8,0,0,1,0,11.32l-32,32a8,8,0,0,1-11.32,0l-32-32a8,8,0,0,1,11.32-11.32L72,188.69V48a8,8,0,0,1,16,0V188.69l18.34-18.35A8,8,0,0,1,117.66,170.34Zm96-96-32-32a8,8,0,0,0-11.32,0l-32,32a8,8,0,0,0,11.32,11.32L168,67.31V208a8,8,0,0,0,16,0V67.31l18.34,18.35a8,8,0,0,0,11.32-11.32Z"}))],["fill",n.createElement(n.Fragment,null,n.createElement("path",{d:"M119.39,172.94a8,8,0,0,1-1.73,8.72l-32,32a8,8,0,0,1-11.32,0l-32-32A8,8,0,0,1,48,168H72V48a8,8,0,0,1,16,0V168h24A8,8,0,0,1,119.39,172.94Zm94.27-98.6-32-32a8,8,0,0,0-11.32,0l-32,32A8,8,0,0,0,144,88h24V208a8,8,0,0,0,16,0V88h24a8,8,0,0,0,5.66-13.66Z"}))],["light",n.createElement(n.Fragment,null,n.createElement("path",{d:"M116.24,171.76a6,6,0,0,1,0,8.48l-32,32a6,6,0,0,1-8.48,0l-32-32a6,6,0,0,1,8.48-8.48L74,193.51V48a6,6,0,0,1,12,0V193.51l21.76-21.75A6,6,0,0,1,116.24,171.76Zm96-96-32-32a6,6,0,0,0-8.48,0l-32,32a6,6,0,0,0,8.48,8.48L170,62.49V208a6,6,0,0,0,12,0V62.49l21.76,21.75a6,6,0,0,0,8.48-8.48Z"}))],["regular",n.createElement(n.Fragment,null,n.createElement("path",{d:"M117.66,170.34a8,8,0,0,1,0,11.32l-32,32a8,8,0,0,1-11.32,0l-32-32a8,8,0,0,1,11.32-11.32L72,188.69V48a8,8,0,0,1,16,0V188.69l18.34-18.35A8,8,0,0,1,117.66,170.34Zm96-96-32-32a8,8,0,0,0-11.32,0l-32,32a8,8,0,0,0,11.32,11.32L168,67.31V208a8,8,0,0,0,16,0V67.31l18.34,18.35a8,8,0,0,0,11.32-11.32Z"}))],["thin",n.createElement(n.Fragment,null,n.createElement("path",{d:"M114.83,173.17a4,4,0,0,1,0,5.66l-32,32a4,4,0,0,1-5.66,0l-32-32a4,4,0,0,1,5.66-5.66L76,198.34V48a4,4,0,0,1,8,0V198.34l25.17-25.17A4,4,0,0,1,114.83,173.17Zm96-96-32-32a4,4,0,0,0-5.66,0l-32,32a4,4,0,0,0,5.66,5.66L172,57.66V208a4,4,0,0,0,8,0V57.66l25.17,25.17a4,4,0,1,0,5.66-5.66Z"}))]]),Oe=n.forwardRef((R,F)=>n.createElement(ss,{ref:F,...R,weights:ds}));Oe.displayName="ArrowsDownUpIcon";const u=Oe,Q=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8","#82ca9d","#ffc658","#ff7300"],ws=()=>{const{apiCall:R}=ls(),[F,ce]=n.useState([]),[de,ie]=n.useState(!0),[J,xe]=n.useState(null),[j,L]=n.useState(null),[$,Re]=n.useState({totalVoucherGerado:0,totalTransacoes:0,totalDesconto:0,clientesUnicos:0,percentualDesconto:0,valorLiquido:0,vendasAcima35:0,totalDescontoAcima35:0}),[K,ze]=n.useState([]),[he,qe]=n.useState([]),[q,me]=n.useState({}),[G,Ge]=n.useState({}),[pe,Pe]=n.useState([]),[ue,Ze]=n.useState([]),[je,We]=n.useState([]),[W,Ie]=n.useState(()=>{const s=new Date;return s.setDate(s.getDate()-180),s.toISOString().split("T")[0]}),[I,Ue]=n.useState(()=>new Date().toISOString().split("T")[0]),[U,He]=n.useState("dt_transacao"),[O,Xe]=n.useState([]),[i,ge]=n.useState(null),[m,H]=n.useState("none"),[ee,be]=n.useState([]),[x,ve]=n.useState(null),[p,X]=n.useState("none"),[ye,fe]=n.useState([]),[se,is]=n.useState(1e3),[Ye,Ne]=n.useState(0),[Qe,Je]=n.useState(!1),[we,_e]=n.useState(!1),Fe=async s=>{try{const a=[...new Set(s.map(o=>o.cd_empresa).filter(o=>o!=null))];if(a.length===0)return{};const r=await R("/api/company/empresas",{cd_empresa:a.join(",")});if(r.success&&Array.isArray(r.data)){const o={};return r.data.forEach(l=>{o[String(l.cd_empresa)]=l.nm_grupoempresa}),me(o),o}return{}}catch(a){return console.warn("Erro ao buscar nomes de empresas:",a),{}}},De=async s=>{try{const a=[...new Set(s.map(o=>o.cd_compvend).filter(o=>o!=null))];if(a.length===0)return{};const r=await R("/api/faturamento/pes_vendedor",{cd_vendedor:a.join(",")});if(r.success&&Array.isArray(r.data)){const o={};return r.data.forEach(l=>{o[String(l.cd_vendedor)]=l.nm_vendedor}),Ge(o),o}return{}}catch(a){return console.warn("Erro ao buscar nomes de vendedores:",a),{}}},Y=async(s={},a={append:!1})=>{try{a.append?_e(!0):ie(!0),xe(null);const r={...s,limit:se,offset:a.append?Ye:0},o=await R("/api/faturamento/analise-cashback",r);if(o.success){let l=o.data||[];if(l=l.filter(t=>{const c=t.nr_transacao?String(t.nr_transacao):"",d=t.nr_voucher?String(t.nr_voucher):"";return!(c==="679515"||d==="85626")}),a.append){const t=[...F,...l];ce(t);const c=await Fe(t),d=await De(t);ke(t),te(t,c),Ve(t),ae(t,c),oe(t,d),re(t,d)}else{ce(l);const t=await Fe(l),c=await De(l);ke(l),te(l,t),Ve(l),ae(l,t),oe(l,c),re(l,c)}Je(!!o.hasMore),a.append?Ne(t=>t+se):Ne(se)}else throw new Error(o.message||"Erro ao buscar dados")}catch(r){console.error("Erro ao buscar análise de cashback:",r),xe(r.message)}finally{ie(!1),_e(!1)}},ke=s=>{const a=s.reduce((g,V)=>g+parseFloat(V.vl_voucher||0),0),r=s.reduce((g,V)=>g+parseFloat(V.vl_bruto||0),0),o=s.reduce((g,V)=>g+parseFloat(V.vl_total||0),0),l=s.reduce((g,V)=>g+parseFloat(V.vl_desconto||0),0),t=new Set(s.map(g=>g.cd_pessoa)).size,c=r>0?l/r*100:0;let d=0,f=0;s.forEach(g=>{let V=null;if(g.pct_desconto_bruto!==void 0&&g.pct_desconto_bruto!==null)V=parseFloat(g.pct_desconto_bruto||0);else{const Se=parseFloat(g.vl_bruto||parseFloat(g.vl_total||0)+parseFloat(g.vl_desconto||0)),es=parseFloat(g.vl_desconto||0);V=Se>0?es/Se*100:0}V>35&&(d+=1,f+=parseFloat(g.vl_desconto||0))}),Re({totalVoucherGerado:a,totalTransacoes:r,totalDesconto:l,clientesUnicos:t,percentualDesconto:c,valorLiquido:o,vendasAcima35:d,totalDescontoAcima35:f})},te=(s,a=null)=>{const r=new Map,o=a||q;s.forEach(t=>{const c=t.cd_empresa;r.has(c)||r.set(c,{cd_empresa:c,nome_empresa:o[String(c)]||`Empresa ${c}`,vouchers:0,transacoesBruto:0,transacoesLiquido:0,desconto:0,clientes:new Set});const d=r.get(c);d.vouchers+=parseFloat(t.vl_voucher||0),d.transacoesBruto+=parseFloat(t.vl_bruto||0),d.transacoesLiquido+=parseFloat(t.vl_total||0),d.desconto+=parseFloat(t.vl_desconto||0),d.clientes.add(t.cd_pessoa)});const l=Array.from(r.values()).map(t=>({...t,clientes:t.clientes.size,percentualDesconto:t.transacoesBruto>0?t.desconto/t.transacoesBruto*100:0}));ze(l)},Ve=s=>{const a=new Map;s.forEach(o=>{const l=o.dt_transacao?new Date(o.dt_transacao).toISOString().split("T")[0]:null;if(!l)return;a.has(l)||a.set(l,{data:l,vouchers:0,transacoesBruto:0,transacoesLiquido:0,desconto:0,clientes:new Set});const t=a.get(l);t.vouchers+=parseFloat(o.vl_voucher||0),t.transacoesBruto+=parseFloat(o.vl_bruto||0),t.transacoesLiquido+=parseFloat(o.vl_total||0),t.desconto+=parseFloat(o.vl_desconto||0),t.clientes.add(o.cd_pessoa)});const r=Array.from(a.values()).map(o=>({...o,clientes:o.clientes.size,data:new Date(o.data).toLocaleDateString("pt-BR")})).sort((o,l)=>new Date(o.data.split("/").reverse().join("-"))-new Date(l.data.split("/").reverse().join("-")));qe(r.slice(-30))},P=s=>{i===s?m==="none"?H("asc"):m==="asc"?H("desc"):(H("none"),ge(null)):(ge(s),H("asc"))};n.useEffect(()=>{if(i===null||m==="none")be([...F]);else{const s=[...F].sort((a,r)=>{let o,l;switch(i){case"vl_bruto":o=parseFloat(a.vl_bruto||0),l=parseFloat(r.vl_bruto||0);break;case"vl_desconto":o=parseFloat(a.vl_desconto||0),l=parseFloat(r.vl_desconto||0);break;case"vl_total":o=parseFloat(a.vl_total||0),l=parseFloat(r.vl_total||0);break;case"pct_desconto_bruto":o=parseFloat(a.pct_desconto_bruto||0),l=parseFloat(r.pct_desconto_bruto||0);break;case"vl_voucher":o=parseFloat(a.vl_voucher||0),l=parseFloat(r.vl_voucher||0);break;default:return 0}return m==="asc"?o-l:l-o});be(s)}},[F,i,m]),n.useEffect(()=>{if(x===null||p==="none")fe([...K]);else{const s=[...K].sort((a,r)=>{let o,l;switch(x){case"vouchers":o=parseFloat(a.vouchers||0),l=parseFloat(r.vouchers||0);break;case"transacoesBruto":o=parseFloat(a.transacoesBruto||0),l=parseFloat(r.transacoesBruto||0);break;case"desconto":o=parseFloat(a.desconto||0),l=parseFloat(r.desconto||0);break;case"percentualDesconto":o=parseFloat(a.percentualDesconto||0),l=parseFloat(r.percentualDesconto||0);break;case"clientes":o=parseInt(a.clientes||0),l=parseInt(r.clientes||0);break;default:return 0}return p==="asc"?o-l:l-o});fe(s)}},[K,x,p]);const ae=(s,a=null)=>{const r=new Map,o=a||q;s.forEach(t=>{let c=null;if(t.pct_desconto_bruto!==void 0&&t.pct_desconto_bruto!==null)c=parseFloat(t.pct_desconto_bruto||0);else{const d=parseFloat(t.vl_bruto||parseFloat(t.vl_total||0)+parseFloat(t.vl_desconto||0)),f=parseFloat(t.vl_desconto||0);c=d>0?f/d*100:0}if(c>35){const d=String(t.cd_empresa||"unknown");r.has(d)||r.set(d,{cd_empresa:d,nome_loja:o[d]||`Loja ${d}`,descontoTotal:0,valorTransacoes:0,transacoes:0});const f=r.get(d);f.descontoTotal+=parseFloat(t.vl_desconto||0),f.valorTransacoes+=parseFloat(t.vl_bruto||0),f.transacoes+=1}});const l=Array.from(r.values()).map(t=>({...t,mediaDescontoPorTransacao:t.transacoes>0?t.descontoTotal/t.transacoes:0,nome_loja_label:`${t.nome_loja} (${t.transacoes} tx)`}));l.sort((t,c)=>c.descontoTotal-t.descontoTotal),Pe(l)},oe=(s,a=null)=>{const r=new Map,o=a||G;s.forEach(t=>{const c=String(t.cd_compvend||"unknown");r.has(c)||r.set(c,{cd_vendedor:c,nome_vendedor:o[c]||`Vendedor ${c}`,descontoTotal:0,valorTransacoes:0,transacoes:0});const d=r.get(c);d.descontoTotal+=parseFloat(t.vl_desconto||0),d.valorTransacoes+=parseFloat(t.vl_bruto||0),d.transacoes+=1});const l=Array.from(r.values()).map(t=>({...t,nome_vendedor_label:`${t.nome_vendedor} (${t.transacoes} tx)`}));l.sort((t,c)=>c.valorTransacoes-t.valorTransacoes),Ze(l)},re=(s,a=null)=>{const r=new Map,o=a||G;s.forEach(t=>{let c=null;if(t.pct_desconto_bruto!==void 0&&t.pct_desconto_bruto!==null)c=parseFloat(t.pct_desconto_bruto||0);else{const d=parseFloat(t.vl_bruto||parseFloat(t.vl_total||0)+parseFloat(t.vl_desconto||0)),f=parseFloat(t.vl_desconto||0);c=d>0?f/d*100:0}if(c>35){const d=String(t.cd_compvend||"unknown");r.has(d)||r.set(d,{cd_vendedor:d,nome_vendedor:o[d]||`Vendedor ${d}`,descontoTotal:0,valorTransacoes:0,transacoes:0});const f=r.get(d);f.descontoTotal+=parseFloat(t.vl_desconto||0),f.valorTransacoes+=parseFloat(t.vl_bruto||0),f.transacoes+=1}});const l=Array.from(r.values()).map(t=>({...t,nome_vendedor_label:`${t.nome_vendedor} (${t.transacoes} tx)`}));l.sort((t,c)=>c.descontoTotal-t.descontoTotal),We(l)},Z=s=>{x===s?p==="none"?X("asc"):p==="asc"?X("desc"):(X("none"),ve(null)):(ve(s),X("asc"))};n.useEffect(()=>{(async()=>{try{const r=await R("/api/company/empresas");if(r.success&&Array.isArray(r.data)){const o={};r.data.forEach(l=>{o[String(l.cd_empresa)]=l.nm_grupoempresa}),me(o)}}catch(r){console.warn("Erro ao buscar nomes de empresas:",r)}const a={dataInicio:W,dataFim:I,cd_empresa:O.length>0?O.map(r=>r.cd_empresa).join(","):void 0,dateField:U};await Y(a)})()},[]),n.useEffect(()=>{Object.keys(q).length>0&&F.length>0&&(te(F),ae(F))},[q]),n.useEffect(()=>{Object.keys(G).length>0&&F.length>0&&(oe(F),re(F))},[G]);const h=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s),Te=s=>`${s.toFixed(1)}%`;return e.jsxs("div",{className:"w-full",children:[e.jsx(ts,{title:"Análise de Cashback - Crosby",description:"Análise detalhada do programa de cashback com métricas de performance e utilização"}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx(as,{title:"Análise de Cashback",subtitle:"Dashboard completo do programa de cashback com métricas de performance e utilização",icon:Ee,iconColor:"text-green-600"}),e.jsx("div",{className:"mb-4",children:e.jsx("form",{className:"flex flex-col bg-white p-3 rounded-lg shadow-lg w-full max-w-4xl mx-auto border border-[#000638]/10 gap-5 p-5",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("span",{className:"text-lg font-bold text-[#000638] flex items-center gap-1",children:[e.jsx(cs,{size:18,weight:"bold"}),"Filtros"]}),e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Selecione o período e empresa para análise"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Data Início"}),e.jsx("input",{type:"date",value:W,onChange:s=>Ie(s.target.value),className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] placeholder:text-gray-400 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Data Fim"}),e.jsx("input",{type:"date",value:I,onChange:s=>Ue(s.target.value),className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] placeholder:text-gray-400 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Campo de Data"}),e.jsxs("select",{value:U,onChange:s=>He(s.target.value),className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] text-xs",children:[e.jsx("option",{value:"dt_transacao",children:"Transação"}),e.jsx("option",{value:"dt_voucher",children:"Criação Voucher"})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(rs,{empresasSelecionadas:O,onSelectEmpresas:s=>Xe(s)})})]}),e.jsx("div",{className:"mt-3 flex justify-between items-center",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{const s={dataInicio:W,dataFim:I,cd_empresa:O.length>0?O.map(a=>a.cd_empresa).join(","):void 0,dateField:U};Y(s)},className:"flex items-center gap-1 bg-[#000638] text-white px-3 py-1 rounded-lg hover:bg-[#fe0000] disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors h-7 text-xs font-bold shadow-md tracking-wide uppercas",children:[e.jsx(Be,{size:16}),"Buscar"]}),e.jsxs("button",{className:"flex items-center gap-1 bg-[#000638] text-white px-3 py-1 rounded-lg hover:bg-[#fe0000] disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors h-7 text-xs font-bold shadow-md tracking-wide",children:[e.jsx(ns,{size:18}),"Exportar"]})]})})]})})}),de&&e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(os,{size:"lg",text:"Carregando análise de cashback..."})}),J&&e.jsx(v,{className:"mt-6",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Erro ao carregar dados"}),e.jsx("p",{className:"text-sm mt-2",children:J}),e.jsx("button",{onClick:Y,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Tentar novamente"})]})})}),!de&&!J&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{size:18,className:"text-green-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Total Vouchers Gerados"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-gray-900 mb-0.5",children:h($.totalVoucherGerado)}),e.jsx(_,{className:"text-xs text-gray-500",children:"Valor total dos vouchers"})]})]}),e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{size:18,className:"text-red-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Vendas com > 35% desconto"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-red-600 mb-0.5",children:$.vendasAcima35.toLocaleString()}),e.jsxs(_,{className:"text-xs text-gray-500",children:["Desconto total:"," ",h($.totalDescontoAcima35)]})]})]}),e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-blue-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Total Transações (Bruto)"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-gray-900 mb-0.5",children:h($.totalTransacoes)}),e.jsx(_,{className:"text-xs text-gray-500",children:"Valor bruto das vendas"})]})]}),e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{size:18,className:"text-orange-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Total Desconto Aplicado"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-orange-600 mb-0.5",children:h($.totalDesconto)}),e.jsxs(_,{className:"text-xs text-gray-500",children:[Te($.percentualDesconto)," do total"]})]})]}),e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{size:18,className:"text-purple-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Clientes Únicos"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-gray-900 mb-0.5",children:$.clientesUnicos.toLocaleString()}),e.jsx(_,{className:"text-xs text-gray-500",children:"Que utilizaram vouchers"})]})]}),e.jsxs(v,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[e.jsx(N,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{size:18,className:"text-indigo-600"}),e.jsx(w,{className:"text-sm font-bold text-[#000638]",children:"Valor Líquido Total"})]})}),e.jsxs(y,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-base font-extrabold text-green-600 mb-0.5",children:h($.valorLiquido)}),e.jsx(_,{className:"text-xs text-gray-500",children:"Após descontos aplicados"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(v,{className:"bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"line",title:"Evolução Temporal (30 dias)",description:"Vouchers, transações e descontos ao longo do tempo",data:he}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900",children:"Evolução Temporal (30 dias)"}),e.jsx(_,{children:"Vouchers, transações e descontos ao longo do tempo"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:300,children:e.jsxs(Me,{data:he,children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"data"}),e.jsx(C,{tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>`Data: ${s}`}),e.jsx(A,{}),e.jsx(z,{type:"monotone",dataKey:"vouchers",stroke:"#10B981",strokeWidth:3,name:"Vouchers Gerados",dot:{fill:"#10B981",strokeWidth:2,r:4}}),e.jsx(z,{type:"monotone",dataKey:"transacoesBruto",stroke:"#3B82F6",strokeWidth:3,name:"Valor Transações (Bruto)",dot:{fill:"#3B82F6",strokeWidth:2,r:4}}),e.jsx(z,{type:"monotone",dataKey:"desconto",stroke:"#F59E0B",strokeWidth:3,name:"Desconto Aplicado",dot:{fill:"#F59E0B",strokeWidth:2,r:4}})]})})})})]}),e.jsxs(v,{className:"bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"pie",title:"Distribuição por Empresa",description:"Participação das empresas no programa de cashback",data:K}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900",children:"Distribuição por Empresa"}),e.jsx(_,{children:"Participação das empresas no programa de cashback"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:300,children:e.jsxs(Le,{children:[e.jsx($e,{data:K.slice(0,8),cx:"50%",cy:"50%",labelLine:!1,label:({nome_empresa:s,percent:a})=>`${s}: ${(a*100).toFixed(1)}%`,outerRadius:80,fill:"#8884d8",dataKey:"vouchers",children:K.slice(0,8).map((s,a)=>e.jsx(Ke,{fill:Q[a%Q.length]},`cell-${a}`))}),e.jsx(k,{formatter:(s,a,r)=>[h(s),r.payload.nome_empresa]})]})})})})]})]}),e.jsxs(v,{className:"bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"bar",title:"Performance por Empresa",description:"Comparativo de vouchers, transações e descontos por empresa",data:K}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900 ",children:"Performance por Empresa"}),e.jsx(_,{children:"Comparativo de vouchers, transações e descontos por empresa"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:400,children:e.jsxs(M,{data:K.slice(0,10),children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"nome_empresa"}),e.jsx(C,{tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(k,{formatter:(s,a)=>a==="Clientes"?[s.toLocaleString(),"Clientes"]:[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"vouchers",fill:"#10B981",name:"Vouchers Gerados"}),e.jsx(b,{dataKey:"transacoesBruto",fill:"#3B82F6",name:"Valor Transações (Bruto)"}),e.jsx(b,{dataKey:"desconto",fill:"#F59E0B",name:"Desconto"})]})})})})]}),e.jsxs(v,{className:"mt-6 bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"barAbove35",title:"Descontos >35% por Loja",description:"Lojas que concederam descontos acima de 35% - total de desconto e valor das transações",data:pe}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900 ",children:"Descontos >35% por Loja"}),e.jsx(_,{children:"Lojas que mais concederam descontos superiores a 35%"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:300,children:e.jsxs(M,{data:pe.slice(0,10),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_loja_label",width:260}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"})]})})})})]}),e.jsxs(v,{className:"mt-6 bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"barVendedorGeral",title:"Vendedores que Mais Venderam com Voucher",description:"Ranking de vendedores por valor de transações e desconto aplicado em vendas com voucher",data:ue}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900 ",children:"Vendedores - Vendas com Voucher"}),e.jsx(_,{children:"Ranking dos vendedores que mais venderam utilizando vouchers"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:300,children:e.jsxs(M,{data:ue.slice(0,10),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_vendedor_label",width:260}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"})]})})})})]}),e.jsxs(v,{className:"mt-6 bg-white shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl cursor-pointer",onClick:()=>L({type:"barVendedorAbove35",title:"Vendedores com Vendas >35% de Desconto",description:"Vendedores que realizaram vendas com desconto acima de 35% - total de desconto e valor das transações",data:je}),children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900 ",children:"Vendedores - Descontos >35%"}),e.jsx(_,{children:"Vendedores que mais venderam com descontos superiores a 35%"})]}),e.jsx(y,{children:e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-4 border border-[#000638]/10",children:e.jsx(D,{width:"100%",height:300,children:e.jsxs(M,{data:je.slice(0,10),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_vendedor_label",width:260}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"})]})})})})]}),e.jsxs(v,{className:"mt-6 bg-white",children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900",children:"Detalhamento por Empresa"}),e.jsx(_,{children:"Métricas completas por empresa"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Empresa"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>Z("vouchers"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Vouchers Gerados",children:["Vouchers Gerados",x==="vouchers"&&p==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),x==="vouchers"&&p==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),x==="vouchers"&&p==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),x!=="vouchers"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>Z("transacoesBruto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Valor Transações",children:["Valor Transações",x==="transacoesBruto"&&p==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),x==="transacoesBruto"&&p==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),x==="transacoesBruto"&&p==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),x!=="transacoesBruto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>Z("desconto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Desconto Aplicado",children:["Desconto Aplicado",x==="desconto"&&p==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),x==="desconto"&&p==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),x==="desconto"&&p==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),x!=="desconto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>Z("percentualDesconto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por % Desconto",children:["% Desconto",x==="percentualDesconto"&&p==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),x==="percentualDesconto"&&p==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),x==="percentualDesconto"&&p==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),x!=="percentualDesconto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>Z("clientes"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Clientes",children:["Clientes",x==="clientes"&&p==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),x==="clientes"&&p==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),x==="clientes"&&p==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),x!=="clientes"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})})]})}),e.jsx("tbody",{children:ye.map((s,a)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-indigo-600"})}),e.jsx("span",{className:"font-medium text-gray-900",children:s.nome_empresa})]})}),e.jsx("td",{className:"text-right py-3 px-4 font-medium text-gray-900",children:h(s.vouchers)}),e.jsx("td",{className:"text-right py-3 px-4 text-gray-700",children:h(s.transacoesBruto)}),e.jsx("td",{className:"text-right py-3 px-4 text-gray-700",children:h(s.desconto)}),e.jsx("td",{className:"text-right py-3 px-4 text-gray-700",children:Te(s.percentualDesconto)}),e.jsx("td",{className:"text-right py-3 px-4 text-gray-700",children:s.clientes.toLocaleString()})]},a))})]})}),ye.length>0&&x&&p!=="none"&&e.jsx("div",{className:"mt-4 flex items-center justify-end text-sm text-gray-500 px-4",children:e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Ordenado por"," ",x==="vouchers"?"Vouchers Gerados":x==="transacoesBruto"?"Valor Transações":x==="desconto"?"Desconto Aplicado":x==="percentualDesconto"?"% Desconto":x==="clientes"?"Clientes":""," ",p==="asc"?"↑":"↓"]})})]})]}),e.jsxs(v,{className:"mt-6 bg-white",children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-lg font-bold text-gray-900",children:"Transações por Cliente"}),e.jsx(_,{children:"Detalhamento completo de todas as transações com vouchers"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Cliente"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Nº Transação"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Data"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Loja"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Vendedor"}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>P("vl_bruto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Valor Transação",children:["Valor Transação",i==="vl_bruto"&&m==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),i==="vl_bruto"&&m==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),i==="vl_bruto"&&m==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),i!=="vl_bruto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>P("vl_desconto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Desconto",children:["Desconto",i==="vl_desconto"&&m==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),i==="vl_desconto"&&m==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),i==="vl_desconto"&&m==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),i!=="vl_desconto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>P("vl_total"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Valor Líquido",children:["Valor Líquido",i==="vl_total"&&m==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),i==="vl_total"&&m==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),i==="vl_total"&&m==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),i!=="vl_total"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>P("pct_desconto_bruto"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por % Desconto",children:["% Desconto",i==="pct_desconto_bruto"&&m==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),i==="pct_desconto_bruto"&&m==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),i==="pct_desconto_bruto"&&m==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),i!=="pct_desconto_bruto"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})}),e.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:e.jsxs("button",{onClick:()=>P("vl_voucher"),className:"flex items-center gap-2 ml-auto hover:text-gray-900 transition-colors",title:"Ordenar por Voucher",children:["Voucher",i==="vl_voucher"&&m==="none"&&e.jsx(u,{className:"w-4 h-4 text-gray-400"}),i==="vl_voucher"&&m==="asc"&&e.jsx(S,{className:"w-4 h-4 text-green-600"}),i==="vl_voucher"&&m==="desc"&&e.jsx(T,{className:"w-4 h-4 text-blue-600"}),i!=="vl_voucher"&&e.jsx(u,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})]})})]})}),e.jsx("tbody",{children:ee.map((s,a)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-4 h-4 text-blue-600"})}),e.jsx("div",{children:e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:s.cd_pessoa})})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm text-gray-700",children:s.nr_transacao})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:s.dt_transacao?new Date(s.dt_transacao).toLocaleDateString("pt-BR"):"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ne,{className:"w-4 h-4 text-green-600"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:q[String(s.cd_empresa)]||`Loja ${s.cd_empresa}`})]})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-700",children:G[String(s.cd_compvend)]||`Vendedor ${s.cd_compvend||"-"}`}),e.jsx("td",{className:"text-right py-3 px-4 font-medium text-gray-900",children:h(parseFloat(s.vl_bruto||0))}),e.jsx("td",{className:"text-right py-3 px-4 text-orange-600 font-medium",children:h(parseFloat(s.vl_desconto||0))}),e.jsx("td",{className:"text-right py-3 px-4 text-green-600 font-semibold",children:h(parseFloat(s.vl_total||0))}),e.jsx("td",{className:"text-right py-3 px-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:s.pct_desconto_bruto?`${parseFloat(s.pct_desconto_bruto).toFixed(1)}%`:"0%"})}),e.jsx("td",{className:"text-right py-3 px-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:h(parseFloat(s.vl_voucher||0))})})]},a))})]})}),ee.length>0&&e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm text-gray-500 px-4",children:[e.jsxs("span",{children:["Mostrando ",ee.length," transações com vouchers"]}),i&&m!=="none"&&e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded",children:["Ordenado por"," ",i==="vl_bruto"?"Valor Transação":i==="vl_desconto"?"Desconto":i==="vl_total"?"Valor Líquido":i==="pct_desconto_bruto"?"% Desconto":i==="vl_voucher"?"Voucher":""," ",m==="asc"?"↑":"↓"]})]}),Qe&&e.jsx("div",{className:"mt-4 flex items-center justify-center",children:e.jsx("button",{onClick:()=>{const s={dataInicio:W,dataFim:I,cd_empresa:O.length>0?O.map(a=>a.cd_empresa).join(","):void 0,dateField:U};Y(s,{append:!0})},disabled:we,className:"px-4 py-2 bg-[#000638] text-white rounded-lg hover:bg-[#fe0000] disabled:opacity-50",children:we?"Carregando...":"Carregar mais"})})]})]}),j&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>L(null),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-6xl w-full flex flex-col items-center relative",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>L(null),className:"absolute top-4 right-4 text-gray-500 hover:text-red-600 text-2xl font-bold","aria-label":"Fechar",children:"×"}),e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[j.type==="line"&&e.jsx(Be,{size:28,className:"text-[#000638]"}),j.type==="pie"&&e.jsx(ne,{size:28,className:"text-[#000638]"}),j.type==="bar"&&e.jsx(le,{size:28,className:"text-[#000638]"}),e.jsx("span",{className:"text-2xl font-bold text-[#000638]",children:j.title})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:j.description}),e.jsxs("div",{className:"w-full flex items-center justify-center",style:{height:"500px"},children:[j.type==="line"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(Me,{data:j.data,children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"data"}),e.jsx(C,{tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>`Data: ${s}`}),e.jsx(A,{}),e.jsx(z,{type:"monotone",dataKey:"vouchers",stroke:"#10B981",strokeWidth:3,name:"Vouchers Gerados",dot:{fill:"#10B981",strokeWidth:2,r:4}}),e.jsx(z,{type:"monotone",dataKey:"transacoesBruto",stroke:"#3B82F6",strokeWidth:3,name:"Valor Transações (Bruto)",dot:{fill:"#3B82F6",strokeWidth:2,r:4}}),e.jsx(z,{type:"monotone",dataKey:"desconto",stroke:"#F59E0B",strokeWidth:3,name:"Desconto Aplicado",dot:{fill:"#F59E0B",strokeWidth:2,r:4}})]})}),j.type==="pie"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(Le,{children:[e.jsx($e,{data:j.data.slice(0,8),cx:"50%",cy:"50%",labelLine:!1,label:({nome_empresa:s,percent:a})=>`${s}: ${(a*100).toFixed(1)}%`,outerRadius:150,fill:"#8884d8",dataKey:"vouchers",children:j.data.slice(0,8).map((s,a)=>e.jsx(Ke,{fill:Q[a%Q.length]},`cell-${a}`))}),e.jsx(k,{formatter:(s,a,r)=>[h(s),r.payload.nome_empresa]})]})}),j.type==="bar"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(M,{data:j.data.slice(0,10),children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{dataKey:"nome_empresa"}),e.jsx(C,{tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(k,{formatter:(s,a)=>a==="Clientes"?[s.toLocaleString(),"Clientes"]:[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"vouchers",fill:"#10B981",name:"Vouchers Gerados"}),e.jsx(b,{dataKey:"transacoesBruto",fill:"#3B82F6",name:"Valor Transações (Bruto)"}),e.jsx(b,{dataKey:"desconto",fill:"#F59E0B",name:"Desconto"})]})}),j.type==="barAbove35"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(M,{data:j.data.slice(0,20),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_loja_label",width:300}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"})]})}),j.type==="barVendedorGeral"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(M,{data:j.data.slice(0,20),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_vendedor_label",width:300}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"})]})}),j.type==="barVendedorAbove35"&&e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(M,{data:j.data.slice(0,20),layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3"}),e.jsx(B,{type:"number",tickFormatter:s=>`R$ ${(s/1e3).toFixed(0)}k`}),e.jsx(C,{type:"category",dataKey:"nome_vendedor_label",width:300}),e.jsx(k,{formatter:(s,a)=>[h(s),a],labelFormatter:s=>s}),e.jsx(A,{}),e.jsx(b,{dataKey:"descontoTotal",fill:"#F59E0B",name:"Desconto Total"}),e.jsx(b,{dataKey:"valorTransacoes",fill:"#3B82F6",name:"Valor Transações"})]})})]})]})})]})]})]})};export{ws as default};
