import{f as b,_ as Sa,r as d,j as e,S as ka}from"./index-a2563983.js";import{l as g,I as v,F as Pa}from"./FilterDropdown-c1467603.js";import{B as f}from"./Button-3b4dd265.js";import{M as J}from"./Modal-8500ef4b.js";import{T as Da}from"./Table-ce37d0f3.js";import{m as w}from"./Question.es-1a269825.js";import{u as Ta}from"./usePermissions-4c389311.js";import{C as Z,a as ee,b as ae,c as te,d as se}from"./cards-fd94db0b.js";import{R as Oe,B as _a,b as Ea,X as Fa,Y as Aa,T as qe,L as Je,c as za,P as Ra,a as Ia,C as Oa}from"./PieChart-2e5dc4ea.js";import"./CaretUp.es-b369da07.js";import"./CaretUpDown.es-453a995a.js";const xe="contratos-endividamento",$=s=>s?Number(s)/100:null,L=s=>s==null?"":String(Math.round(Number(s)*100)),$e=s=>{const o=(s||"").replace(/\D/g,"");return o?Number(o):null};function We(s,o,n){return{user_id:o,instituicao:s.instituicao||null,razao_social_tomador:s.razaoSocialTomador||null,cnpj_tomador:s.cnpjTomador||null,ag:s.ag||null,cc:s.cc||null,linha_credito:s.linhaCredito||null,numero_contrato:s.numeroContrato||null,data_contratacao:s.dataContratacao||null,vencimento_final:s.vencimentoFinal||null,limite_aprovado:$(s.limiteAprovado),saldo_devedor_sem_juros:$(s.saldoDevedorSemJuros),saldo_devedor_com_juros:$(s.saldoDevedorComJuros),valor_mensal_pmt:$(s.valorMensalPMT),quantidade_pmt:$e(s.quantidadePMT),pmt_pagas:$e(s.pmtPagas),diferenca_pmt_vencer:$(s.diferencaPMTVencer),data_inicial_pagamento:s.dataInicialPagamento||null,taxa_juros_mes:s.taxaJurosMes?Number(s.taxaJurosMes):null,avalista:s.avalista||null,garantias:s.garantias||null,anexo_path:n||null}}function pe(s){return{id:s.id,instituicao:s.instituicao||"",razaoSocialTomador:s.razao_social_tomador||"",cnpjTomador:s.cnpj_tomador||"",ag:s.ag||"",cc:s.cc||"",linhaCredito:s.linha_credito||"",numeroContrato:s.numero_contrato||"",dataContratacao:s.data_contratacao||"",vencimentoFinal:s.vencimento_final||"",limiteAprovado:L(s.limite_aprovado),saldoDevedorSemJuros:L(s.saldo_devedor_sem_juros),saldoDevedorComJuros:L(s.saldo_devedor_com_juros),valorMensalPMT:L(s.valor_mensal_pmt),quantidadePMT:s.quantidade_pmt!=null?String(s.quantidade_pmt):"",pmtPagas:s.pmt_pagas!=null?String(s.pmt_pagas):"",diferencaPMTVencer:L(s.diferenca_pmt_vencer),dataInicialPagamento:s.data_inicial_pagamento||"",taxaJurosMes:s.taxa_juros_mes!=null?String(s.taxa_juros_mes):"",avalista:s.avalista||"",garantias:s.garantias||"",anexoContrato:s.anexo_path?{name:s.anexo_path.split("/").pop()}:null}}async function Ue(s){if(!s)return null;const{data:{user:o}}=await b.auth.getUser();if(!o)throw new Error("Usuário não autenticado");const n=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():String(Date.now()),r=`${o.id}/${n}_${s.name}`,{error:m}=await b.storage.from(xe).upload(r,s,{upsert:!1});if(m)throw String(m.message||"").toLowerCase().includes("bucket")&&String(m.message||"").toLowerCase().includes("not")&&String(m.message||"").toLowerCase().includes("found")?new Error(`Bucket "${xe}" não encontrado. Crie o bucket no Storage do Supabase (privado) ou altere o nome no código.`):m;return r}async function qa(s,o){const{data:{user:n}}=await b.auth.getUser();if(!n)throw new Error("Usuário não autenticado");const r=o?await Ue(o):null,m=We(s,n.id,r),{data:j,error:M}=await b.from("endividamentos").insert(m).select().single();if(M)throw M;return pe(j)}async function Ja(s,o,n){const{data:{user:r}}=await b.auth.getUser();if(!r)throw new Error("Usuário não autenticado");const m=n?await Ue(n):void 0,j=We(o,r.id,m);m===void 0&&delete j.anexo_path;const{data:M,error:T}=await b.from("endividamentos").update(j).eq("id",s).eq("user_id",r.id).select().single();if(T)throw T;return pe(M)}async function $a(s){const{data:{user:o}}=await b.auth.getUser();if(!o)throw new Error("Usuário não autenticado");const{data:n,error:r}=await b.from("endividamentos").select("id, user_id, anexo_path").eq("id",s).eq("user_id",o.id).single();if(r)throw r;if(n!=null&&n.anexo_path){const{error:j}=await b.storage.from(xe).remove([n.anexo_path]);j&&console.warn("Falha ao remover anexo do bucket:",j.message||j)}const{error:m}=await b.from("endividamentos").delete().eq("id",s).eq("user_id",o.id);if(m)throw m;return!0}async function Le(){const{data:{user:s}}=await b.auth.getUser();if(!s)throw new Error("Usuário não autenticado");const{data:o,error:n}=await b.from("endividamentos").select("*").order("created_at",{ascending:!1});if(n)throw n;return(o||[]).map(pe)}async function La(){const{data:{user:s}}=await b.auth.getUser();if(!s)throw new Error("Usuário não autenticado");const{error:o}=await b.from("endividamentos").delete().eq("user_id",s.id);if(o)throw o;return!0}function ue(s){if(typeof s=="number")return new Date(Math.round((s-25569)*86400*1e3)).toISOString().slice(0,10);const o=String(s).trim().replace(/\./g,"/").replace(/-/g,"/").split("/");if(o.length===3){const[r,m,j]=o.map(l=>l.padStart(2,"0")),M=j.length===4?j:r.length===4?r:j,T=m.length===2?m:"01",k=r.length===2?r:"01";return`${M}-${T}-${k}`}const n=new Date(s);return Number.isNaN(n.getTime())?null:n.toISOString().slice(0,10)}function Ve(s){return String(s||"").trim().replace(/\s+/g," ").toLowerCase()}function Va(s,o){const n={};Object.keys(s||{}).forEach(l=>{n[Ve(l)]=s[l]});const r=(...l)=>{for(const C of l){const c=Ve(C);if(n[c]!==void 0&&n[c]!==null&&n[c]!=="")return n[c]}return null},m=l=>{if(l==null||l==="")return null;if(typeof l=="number")return l;let c=String(l).trim().replace(/R\$\s?/gi,"");c.includes(",")&&(c=c.replace(/\./g,"").replace(",","."));const F=Number(c);return Number.isNaN(F)?null:F},j=l=>{if(l==null||l==="")return null;if(typeof l=="number")return Math.trunc(l);const C=Number(String(l).replace(/\D/g,""));return Number.isNaN(C)?null:C},M=r("instituição","instituicao"),T=r("razão social - tomador","razão social  - tomador","razao social - tomador"),k=r("número do contrato","numero do contrato");return{user_id:o,instituicao:M||null,razao_social_tomador:T||null,cnpj_tomador:r("cnpj tomador")||null,ag:r("ag")||null,cc:r("cc")||null,linha_credito:r("linha de crédito","linha de credito")||null,numero_contrato:k||null,data_contratacao:r("data da contratação")?ue(r("data da contratação")):null,vencimento_final:r("vencimento final da operação")?ue(r("vencimento final da operação")):null,limite_aprovado:m(r("limites aprovados/ valor do contrato")),saldo_devedor_sem_juros:m(r("saldo devedor nominal s/ juros")),saldo_devedor_com_juros:m(r("saldo devedor total c/ juros")),valor_mensal_pmt:m(r("valor mensal pmt")),quantidade_pmt:j(r("quantidade pmt")),pmt_pagas:j(r("quantas já pagamos pmt paga")),diferenca_pmt_vencer:m(r("diferença pmt a vencer")),data_inicial_pagamento:r("data inicial de pagamento")?ue(r("data inicial de pagamento")):null,taxa_juros_mes:r("taxa juros % a.m")!=null?Number(String(r("taxa juros % a.m")).replace(",",".")):null,avalista:r("avalista")||null,garantias:r("garantias")||null,anexo_path:null}}async function Ba(s){const{data:{user:o}}=await b.auth.getUser();if(!o)throw new Error("Usuário não autenticado");const n=await Sa(()=>import("./xlsx-6ed613d4.js"),[]),r=await s.arrayBuffer(),m=n.read(r,{type:"array"}),j=m.Sheets[m.SheetNames[0]],k=n.utils.sheet_to_json(j,{defval:null}).map(c=>Va(c,o.id)).filter(c=>c.instituicao&&c.razao_social_tomador),l=300;let C=0;for(let c=0;c<k.length;c+=l){const F=k.slice(c,c+l),{error:V,count:z}=await b.from("endividamentos").insert(F,{count:"exact"});if(V)throw V;C+=z||F.length}return C}const Be=["#0088FE","#00C49F","#FFBB28","#FF8042","#AF19FF","#FF19B8"],st=()=>{const{canAccessAdmin:s}=Ta(),[o,n]=d.useState({instituicao:"",razaoSocialTomador:"",cnpjTomador:"",ag:"",cc:"",linhaCredito:"",numeroContrato:"",dataContratacao:"",vencimentoFinal:"",limiteAprovado:"",saldoDevedorSemJuros:"",saldoDevedorComJuros:"",valorMensalPMT:"",quantidadePMT:"",pmtPagas:"",diferencaPMTVencer:"",dataInicialPagamento:"",taxaJurosMes:"",avalista:"",garantias:"",anexoContrato:null}),[r,m]=d.useState({}),[j,M]=d.useState(!1),[T,k]=d.useState(!1),[l,C]=d.useState([]),[c,F]=d.useState(null),[V,z]=d.useState(!1),[Ge,he]=d.useState(!1),B=d.useRef(null),[W,ge]=d.useState(!1),[Ye,U]=d.useState(!1),[O,G]=d.useState(null),[ve,je]=d.useState("dashboard"),[Ke,Y]=d.useState(!1),[Qe,fe]=d.useState(!1),[Xe,ye]=d.useState(!1),[He,be]=d.useState(""),[Ze,Ce]=d.useState(""),A=d.useCallback((a,t)=>{be(a),Ce(t),ye(!0)},[]),Ne=d.useCallback(()=>{ye(!1),be(""),Ce("")},[]),ea=()=>{je("dashboard")},aa=()=>{je("table")},oe=d.useCallback(()=>k(!1),[]),[P,Me]=d.useState({}),[ta,sa]=d.useState(null),p=d.useCallback(a=>{sa(t=>t===a?null:a)},[]),oa=d.useCallback((a,t)=>{Me(x=>{if(t)return{...x,[a]:t};{const u={...x};return delete u[a],u}})},[]),we=d.useMemo(()=>{let a=[...l];Object.keys(P).forEach(x=>{const u=P[x];u.searchTerm&&(a=a.filter(D=>String(D[x]).toLowerCase().includes(u.searchTerm.toLowerCase()))),u.selected&&u.selected.length>0&&(a=a.filter(D=>u.selected.includes(String(D[x]))))});const t=Object.keys(P).find(x=>{var u;return(u=P[x])==null?void 0:u.sortDirection});if(t){const{sortDirection:x}=P[t];a.sort((u,D)=>{const _=String(u[t]).toLowerCase(),E=String(D[t]).toLowerCase();return x==="asc"?_.localeCompare(E):E.localeCompare(_)})}return a},[l,P]);d.useEffect(()=>{let a=!0;return(async()=>{try{const t=await Le();a&&C(t)}catch(t){console.error(t)}})(),()=>{a=!1}},[]);const N=a=>{const{name:t,value:x}=a.target;n(u=>({...u,[t]:x}))},y=a=>{const t=Number(a||0);return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t/100)},q=a=>t=>{const x=(t.target.value||"").replace(/\D/g,"");n(u=>({...u,[a]:x}))},ra=a=>{const t=a.target.files&&a.target.files[0]?a.target.files[0]:null;n(x=>({...x,anexoContrato:t}))},re=a=>{if(!a)return"-";try{return new Date(a).toLocaleDateString("pt-BR")}catch{return a}},K=a=>{if(a===""||a===null||a===void 0)return"-";const t=Number(a);return Number.isNaN(t)?String(a):`${(t<=1?t*100:t).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:4})} % a.m`},na=[{key:"instituicao",title:"Instituição",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"razaoSocialTomador",title:"Razão Social",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"cnpjTomador",title:"CNPJ",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"ag",title:"AG",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"cc",title:"CC",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"linhaCredito",title:"Linha de Crédito",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"numeroContrato",title:"Contrato",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"dataContratacao",title:"Data da Contratação",render:a=>re(a),headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"vencimentoFinal",title:"Vencimento Final",render:a=>re(a),headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"limiteAprovado",title:"Valor do Contrato",render:a=>a?y(a):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"saldoDevedorSemJuros",title:"Saldo s/ Juros",render:a=>a?y(a):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"valorMensalPMT",title:"PMT Mensal",render:a=>a?y(a):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"quantidadePMT",title:"Quantidade PMT",render:a=>a!==""&&a!==null&&a!==void 0?Number(a).toLocaleString("pt-BR"):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"pmtPagas",title:"PMT Pagas",render:a=>a!==""&&a!==null&&a!==void 0?Number(a).toLocaleString("pt-BR"):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"diferencaPMTVencer",title:"Diferença PMT a Vencer",render:a=>a?y(a):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"dataInicialPagamento",title:"Data Inicial Pagamento",render:a=>re(a),headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"taxaJurosMes",title:"Taxa juros % a.m",render:a=>K(a),headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"avalista",title:"Avalista",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"garantias",title:"Garantias",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"saldoDevedorComJuros",title:"Saldo c/ Juros",render:a=>a?y(a):"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})},{key:"anexoContrato",title:"Anexo",render:a=>a?a.name||"Arquivo selecionado":"-",headerRender:({column:a})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a.title}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),p(a.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${a.title}`,children:e.jsx(g,{size:16})})]})}],ia=()=>{const a={};return o.instituicao||(a.instituicao="Obrigatório"),o.razaoSocialTomador||(a.razaoSocialTomador="Obrigatório"),o.cnpjTomador&&!/^\d{14}$/.test(o.cnpjTomador.replace(/\D/g,""))&&(a.cnpjTomador="CNPJ inválido"),o.taxaJurosMes&&Number(o.taxaJurosMes)<0&&(a.taxaJurosMes="Valor inválido"),m(a),Object.keys(a).length===0},la=()=>{F(null),n({instituicao:"",razaoSocialTomador:"",cnpjTomador:"",ag:"",cc:"",linhaCredito:"",numeroContrato:"",dataContratacao:"",vencimentoFinal:"",limiteAprovado:"",saldoDevedorSemJuros:"",saldoDevedorComJuros:"",valorMensalPMT:"",quantidadePMT:"",pmtPagas:"",diferencaPMTVencer:"",dataInicialPagamento:"",taxaJurosMes:"",avalista:"",garantias:"",anexoContrato:null}),k(!0)},ca=a=>{F(a.id),n({...a}),k(!0)},da=()=>{c&&z(!0)},ma=async()=>{if(c){he(!0);try{await $a(c),C(a=>a.filter(t=>t.id!==c)),z(!1),oe()}catch(a){console.error(a)}finally{he(!1)}}},ua=async a=>{if(a.preventDefault(),!!ia()){M(!0);try{if(c){const t=await Ja(c,o,o.anexoContrato);C(x=>x.map(u=>u.id===t.id?t:u))}else{const t=await qa(o,o.anexoContrato);C(x=>[t,...x])}oe()}catch(t){console.error(t),alert("Erro ao salvar endividamento")}finally{M(!1)}}},xa=()=>{console.log("Exportar para Excel (placeholder)"),alert("Exportar para Excel (placeholder)")},pa=()=>{var a;return(a=B.current)==null?void 0:a.click()},ha=a=>{const t=a.target.files&&a.target.files[0];t&&(G(t),U(!0))},ga=async()=>{if(O){ge(!0);try{const a=await Ba(O),t=await Le();C(t),U(!1),G(null)}catch(a){console.error(a),alert("Falha ao importar o Excel")}finally{ge(!1),B.current&&(B.current.value="")}}},va=async()=>{fe(!0);try{await La(),C([]),Y(!1)}catch(a){console.error(a),alert("Erro ao remover todos os registros")}finally{fe(!1)}},{totalDividaBruta:ja,wacdMensal:fa,wacdAnualizado:ya,wamMeses:ba,servicoDivida12m:Ca,maturityWallData:Na,concentracaoInstituicaoData:Se,top10Contratos:ke,alerts:Pe}=d.useMemo(()=>{const a=i=>Number(i||0)/100,t=i=>Number(i||0),x=i=>{if(!i)return 0;const h=new Date,R=new Date(i);return(R.getFullYear()-h.getFullYear())*12+(R.getMonth()-h.getMonth())};let u=0,D=0,_=0,E=0,ne=0,De=0;const ie=new Map,le=new Map,Te=[];l.forEach(i=>{const h=a(i.saldoDevedorComJuros),R=t(i.taxaJurosMes),H=a(i.valorMensalPMT),Fe=Number(i.quantidadePMT||0),Ae=Number(i.pmtPagas||0),de=i.vencimentoFinal,ze=i.dataInicialPagamento;if(u+=h,h>0&&R>0&&(D+=h*R,_+=h),h>0&&de){const S=x(de);S>0&&(E+=h*S,ne+=h)}if(H>0&&Fe>Ae&&de&&ze){const S=new Date,Re=new Date(ze);for(let me=Ae;me<Fe;me++){const I=new Date(Re.getFullYear(),Re.getMonth()+me,1);if(I>S&&I<=new Date(S.getFullYear()+1,S.getMonth(),S.getDate())&&(De+=H),I>S&&I<=new Date(S.getFullYear()+1,S.getMonth()+6,S.getDate())){const Ie=`${I.getFullYear()}-${(I.getMonth()+1).toString().padStart(2,"0")}`;ie.set(Ie,(ie.get(Ie)||0)+H)}}}i.instituicao&&h>0&&le.set(i.instituicao,(le.get(i.instituicao)||0)+h),Te.push({instituicao:i.instituicao,numeroContrato:i.numeroContrato,linhaCredito:i.linhaCredito,saldoDevedorComJuros:h,taxaJurosMes:R,valorMensalPMT:H,vencimentoFinal:i.vencimentoFinal})});const _e=_>0?D/_:0,Ee=((1+_e/100)**12-1)*100,ce=ne>0?E/ne:0,Ma=Array.from(ie.entries()).sort((i,h)=>i[0].localeCompare(h[0])).map(([i,h])=>({month:i,value:h})),Q=Array.from(le.entries()).map(([i,h])=>({name:i,value:h})).sort((i,h)=>h.value-i.value),wa=Te.sort((i,h)=>h.saldoDevedorComJuros-i.saldoDevedorComJuros).slice(0,10),X=[];return ce>0&&ce<6&&X.push("WAM < 6 meses: Risco de rolagem elevado. O prazo médio da dívida está muito curto."),Ee>30&&X.push("WACD anual > 30%: Custo da dívida caro. Avaliar renegociação ou busca por linhas mais baratas."),(Q.length>0?Q[0].value/u*100:0)>40&&X.push(`Concentração > 40% em ${Q[0].name}: Risco de concentração elevado. Buscar diversificação das fontes de dívida.`),{totalDividaBruta:u,wacdMensal:_e,wacdAnualizado:Ee,wamMeses:ce,servicoDivida12m:De,maturityWallData:Ma,concentracaoInstituicaoData:Q,top10Contratos:wa,alerts:X}},[l]);return e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6",children:[e.jsx(ka,{title:"Endividamento",description:"Indicadores de endividamento"}),e.jsx("h1",{className:"text-xl font-semibold text-[#000638]",children:"Endividamento"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"secondary",className:"mr-2",loading:W,onClick:ea,children:"DASHBOARD"}),e.jsx(f,{variant:"secondary",className:"mr-2",loading:W,onClick:aa,children:"TABELA"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{ref:B,type:"file",accept:".xlsx,.xls",onChange:ha,className:"hidden"}),e.jsx(f,{variant:"secondary",onClick:pa,className:"mr-2",loading:W,children:"ADICIONAR ARQUIVO EXCEL"}),s()&&e.jsx(f,{variant:"danger",onClick:()=>Y(!0),className:"mr-2",children:"REMOVER TODOS OS REGISTROS"}),e.jsx(f,{variant:"primary",onClick:la,children:"ADICIONAR NOVO"}),e.jsx(f,{variant:"secondary",onClick:xa,className:"ml-2",children:"BAIXAR EXCEL"})]})]}),Object.keys(P).length>0&&e.jsx("div",{className:"mb-4 text-right",children:e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>Me({}),leftIcon:e.jsx(g,{size:14,className:"text-gray-500"}),children:"Limpar Filtros"})}),e.jsx(J,{isOpen:T,onClose:oe,title:c?"Editar Endividamento":"Adicionar novo endividamento",size:"3xl",children:e.jsxs("form",{onSubmit:ua,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(v,{label:"Instituição",name:"instituicao",value:o.instituicao,onChange:N,required:!0,error:r.instituicao}),e.jsx(v,{label:"Razão Social - Tomador",name:"razaoSocialTomador",value:o.razaoSocialTomador,onChange:N,required:!0,error:r.razaoSocialTomador}),e.jsx(v,{label:"CNPJ Tomador",name:"cnpjTomador",value:o.cnpjTomador,onChange:N,placeholder:"Apenas números",maxLength:18,error:r.cnpjTomador}),e.jsx(v,{label:"AG",name:"ag",value:o.ag,onChange:N}),e.jsx(v,{label:"CC",name:"cc",value:o.cc,onChange:N}),e.jsx(v,{label:"Linha de Crédito",name:"linhaCredito",value:o.linhaCredito,onChange:N}),e.jsx(v,{label:"Número do contrato",name:"numeroContrato",value:o.numeroContrato,onChange:N}),e.jsx(v,{type:"date",label:"Data da Contratação",name:"dataContratacao",value:o.dataContratacao,onChange:N}),e.jsx(v,{type:"date",label:"Vencimento Final da Operação",name:"vencimentoFinal",value:o.vencimentoFinal,onChange:N}),e.jsx(v,{type:"text",label:"Limites Aprovados/ Valor do Contrato",name:"limiteAprovado",value:o.limiteAprovado?y(o.limiteAprovado):"",onChange:q("limiteAprovado"),placeholder:"R$ 0,00",inputMode:"numeric"}),e.jsx(v,{type:"text",label:"Saldo devedor nominal s/ juros",name:"saldoDevedorSemJuros",value:o.saldoDevedorSemJuros?y(o.saldoDevedorSemJuros):"",onChange:q("saldoDevedorSemJuros"),placeholder:"R$ 0,00",inputMode:"numeric"}),e.jsx(v,{type:"text",label:"Saldo devedor total c/ juros",name:"saldoDevedorComJuros",value:o.saldoDevedorComJuros?y(o.saldoDevedorComJuros):"",onChange:q("saldoDevedorComJuros"),placeholder:"R$ 0,00",inputMode:"numeric"}),e.jsx(v,{type:"text",label:"Valor Mensal PMT",name:"valorMensalPMT",value:o.valorMensalPMT?y(o.valorMensalPMT):"",onChange:q("valorMensalPMT"),placeholder:"R$ 0,00",inputMode:"numeric"}),e.jsx(v,{type:"number",label:"Quantidade PMT",name:"quantidadePMT",value:o.quantidadePMT,onChange:N,placeholder:"0",inputMode:"numeric"}),e.jsx(v,{type:"number",label:"Quantas já pagamos PMT paga",name:"pmtPagas",value:o.pmtPagas,onChange:N,placeholder:"0",inputMode:"numeric"}),e.jsx(v,{type:"text",label:"Diferença PMT a vencer",name:"diferencaPMTVencer",value:o.diferencaPMTVencer?y(o.diferencaPMTVencer):"",onChange:q("diferencaPMTVencer"),placeholder:"R$ 0,00",inputMode:"numeric"}),e.jsx(v,{type:"date",label:"Data inicial de pagamento",name:"dataInicialPagamento",value:o.dataInicialPagamento,onChange:N}),e.jsx(v,{type:"number",step:"0.0001",label:"Taxa juros % a.m",name:"taxaJurosMes",value:o.taxaJurosMes,onChange:N,error:r.taxaJurosMes}),e.jsx(v,{label:"Avalista",name:"avalista",value:o.avalista,onChange:N}),e.jsx(v,{label:"Garantias",name:"garantias",value:o.garantias,onChange:N})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Anexo do contrato (PDF ou Word)"}),e.jsx("input",{type:"file",name:"anexoContrato",accept:".pdf,.doc,.docx,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:ra,className:"block w-full text-sm text-gray-900 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-gray-200 file:text-gray-800 hover:file:bg-gray-300"}),o.anexoContrato&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-3",children:[e.jsxs("span",{children:["Selecionado: ",o.anexoContrato.name]}),e.jsx(f,{type:"button",size:"sm",variant:"ghost",onClick:()=>n(a=>({...a,anexoContrato:null})),children:"Remover"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{type:"submit",variant:"primary",loading:j,children:"Salvar"}),e.jsx(f,{type:"button",variant:"secondary",onClick:()=>n({instituicao:"",razaoSocialTomador:"",cnpjTomador:"",ag:"",cc:"",linhaCredito:"",numeroContrato:"",dataContratacao:"",vencimentoFinal:"",limiteAprovado:"",saldoDevedorSemJuros:"",saldoDevedorComJuros:"",valorMensalPMT:"",quantidadePMT:"",pmtPagas:"",diferencaPMTVencer:"",dataInicialPagamento:"",taxaJurosMes:"",avalista:"",garantias:"",anexoContrato:null}),children:"Limpar"}),c&&e.jsx(f,{type:"button",variant:"danger",onClick:da,children:"DELETAR  REGISTRO"})]})]})}),e.jsx(J,{isOpen:V,onClose:()=>z(!1),title:"DESEJA REALMENTE REMOVER O REGISTRO?",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Essa ação não pode ser desfeita."}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>z(!1),children:"NÃO"}),e.jsx(f,{variant:"danger",size:"sm",onClick:ma,loading:Ge,children:"SIM"})]})]})}),e.jsx(J,{isOpen:Ye,onClose:()=>{U(!1),G(null)},title:"DESEJA REALMENTE IMPORTAR O ARQUIVO?",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Arquivo: ",O==null?void 0:O.name]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>{U(!1),G(null)},children:"NÃO"}),e.jsx(f,{variant:"primary",size:"sm",onClick:ga,loading:W,children:"SIM"})]})]})}),e.jsx(J,{isOpen:Ke,onClose:()=>Y(!1),title:"DESEJA REALMENTE REMOVER TODOS OS REGISTROS?",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Essa ação é irreversível."}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>Y(!1),children:"NÃO"}),e.jsx(f,{variant:"danger",size:"sm",onClick:va,loading:Qe,children:"SIM"})]})]})}),e.jsx(J,{isOpen:Xe,onClose:Ne,title:He,size:"lg",children:e.jsxs("div",{className:"space-y-4 text-sm",children:[Ze,e.jsx("div",{className:"flex justify-end",children:e.jsx(f,{variant:"secondary",onClick:Ne,children:"Fechar"})})]})}),ve==="table"&&e.jsx("div",{className:"mt-4",children:e.jsx(Da,{data:we,rowKey:"id",containerClassName:"text-sm",className:"text-sm",onRowClick:a=>ca(a),columns:na.map(a=>({...a,headerRender:({column:t,sortConfig:x,handleSort:u,getSortIcon:D})=>{var _;return e.jsxs("div",{className:"relative flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:E=>{E.stopPropagation(),p(t.key)},className:`hover:text-gray-700 focus:outline-none focus:text-gray-700 ${P[t.key]?"text-blue-600":"text-gray-400"}`,"aria-label":`Filtrar por ${t.title}`,children:e.jsx(g,{size:16})}),ta===t.key&&e.jsx(Pa,{columnKey:t.key,columnTitle:t.title,data:we,currentFilter:P[t.key],onApplyFilter:oa,onClose:()=>p(null)}),!((_=P[t.key])!=null&&_.sortDirection)&&t.sortable!==!1&&e.jsx("span",{className:"cursor-pointer",onClick:E=>{E.stopPropagation(),u(t.key)},children:D(t.key)})]})}})),emptyMessage:"Nenhum endividamento adicionado ainda"})}),ve==="dashboard"&&e.jsxs("div",{className:"p-6 space-y-8 text-sm",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#000638]",children:"Dashboard de Endividamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(Z,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl w-64 bg-white cursor-pointer",children:[e.jsx(ee,{className:"pb-0",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(w,{size:18,className:"text-blue-700"})," ",e.jsxs(ae,{className:"text-sm font-bold text-blue-700 flex items-center",children:["Dívida Bruta Total",e.jsx("button",{type:"button",onClick:()=>A("Dívida Bruta Total",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Pense na **Dívida Bruta** como o valor total de todas as suas dívidas com bancos e outras instituições."}),e.jsx("p",{className:"mt-2",children:"**Como calculamos:** Somamos o *saldo devedor com juros* de todos os seus empréstimos."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Dívida Bruta Total",children:e.jsx(w,{size:16})})]})]})}),e.jsxs(te,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-2xl font-extrabold text-blue-700 mb-1",children:y(ja*100)}),e.jsx(se,{className:"text-xs text-gray-500",children:"Soma de todos os saldos com juros"})]})]}),e.jsxs(Z,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl w-64 bg-white cursor-pointer",children:[e.jsx(ee,{className:"pb-0",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(w,{size:18,className:"text-green-700"})," ",e.jsxs(ae,{className:"text-sm font-bold text-green-700 flex items-center",children:["Custo Médio Ponderado (WACD)",e.jsx("button",{type:"button",onClick:()=>A("Custo Médio Ponderado (WACD)",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"O **WACD** é como se fosse a *média das taxas de juros* que você paga em todos os seus empréstimos, levando em conta o tamanho de cada dívida. Se você tem uma dívida grande com juros altos, ela pesa mais na média."}),e.jsx("p",{className:"mt-2",children:"**Como calculamos (Mensal):** Somamos (cada saldo devedor × sua taxa de juros) e dividimos pela soma de todos os saldos."}),e.jsx("p",{className:"mt-1",children:"**Como calculamos (Anualizado):** Transformamos a taxa mensal em uma taxa anual para ver o custo ao longo de 12 meses."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Custo Médio Ponderado (WACD)",children:e.jsx(w,{size:16})})]})]})}),e.jsxs(te,{className:"pt-0 px-4 pb-4",children:[e.jsxs("div",{className:"text-lg font-bold text-green-700 mb-1",children:["Mensal: ",K(fa),e.jsx("br",{}),"Anualizado: ",K(ya)]}),e.jsx(se,{className:"text-xs text-gray-500",children:"Custo efetivo da dívida"})]})]}),e.jsxs(Z,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl w-64 bg-white cursor-pointer",children:[e.jsx(ee,{className:"pb-0",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(w,{size:18,className:"text-orange-700"})," ",e.jsxs(ae,{className:"text-sm font-bold text-orange-700 flex items-center",children:["Prazo Médio (WAM)",e.jsx("button",{type:"button",onClick:()=>A("Prazo Médio (WAM)",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"O **WAM** é como a *média de tempo* que você ainda tem para pagar todos os seus empréstimos, considerando o tamanho de cada dívida. Se você tem uma dívida grande que vence logo, ela puxa a média para baixo."}),e.jsx("p",{className:"mt-2",children:"**Como calculamos:** Somamos (cada saldo devedor × meses até o vencimento) e dividimos pela soma de todos os saldos."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Prazo Médio (WAM)",children:e.jsx(w,{size:16})})]})]})}),e.jsxs(te,{className:"pt-0 px-4 pb-4",children:[e.jsxs("div",{className:"text-2xl font-extrabold text-orange-700 mb-1",children:[ba.toFixed(1)," meses"]}),e.jsx(se,{className:"text-xs text-gray-500",children:"Tempo médio para vencimento"})]})]}),e.jsxs(Z,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl w-64 bg-white cursor-pointer",children:[e.jsx(ee,{className:"pb-0",children:e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(w,{size:18,className:"text-red-700"})," ",e.jsxs(ae,{className:"text-sm font-bold text-red-700 flex items-center",children:["Serviço da Dívida 12m",e.jsx("button",{type:"button",onClick:()=>A("Serviço da Dívida 12m",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"O **Serviço da Dívida 12m** é o *valor total das parcelas (PMTs)* que você terá que pagar nos próximos 12 meses."}),e.jsx("p",{className:"mt-2",children:"**Como calculamos:** Somamos as parcelas que ainda vão vencer nos próximos 12 meses, de acordo com o valor mensal de cada PMT."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Serviço da Dívida 12m",children:e.jsx(w,{size:16})})]})]})}),e.jsxs(te,{className:"pt-0 px-4 pb-4",children:[e.jsx("div",{className:"text-2xl font-extrabold text-red-700 mb-1",children:y(Ca*100)}),e.jsx(se,{className:"text-xs text-gray-500",children:"PMTs a vencer nos próximos 12 meses"})]})]})]}),Pe.length>0&&e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-lg",role:"alert",children:[e.jsxs("p",{className:"font-bold flex items-center",children:["Alertas Inteligentes",e.jsx("button",{type:"button",onClick:()=>A("Alertas Inteligentes",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Estes são *avisos automáticos* que aparecem quando algo na sua dívida merece atenção. É como um semáforo que acende o amarelo ou vermelho para te alertar!"}),e.jsx("p",{className:"mt-2",children:"**Quando ele te avisa:**"}),e.jsxs("ul",{className:"list-disc list-inside ml-4",children:[e.jsx("li",{children:"`WAM < 6 meses`: Se você tem pouco tempo para pagar suas dívidas, há um *risco de ter que pedir dinheiro novo muito rápido*."}),e.jsx("li",{children:"`WACD anual > 30%`: Se o *custo médio anual dos juros está muito alto*, talvez seja hora de negociar taxas melhores."}),e.jsx("li",{children:"`Concentração > 40% em um banco`: Se você *deve muito dinheiro para um único banco*, pode ser arriscado se algo acontecer com ele. É bom ter dívidas com vários bancos."})]})]})),className:"ml-2 cursor-pointer text-yellow-700 hover:text-yellow-800","aria-label":"Explicar Alertas Inteligentes",children:e.jsx(w,{size:16})})]}),e.jsx("ul",{className:"mt-2 list-disc list-inside",children:Pe.map((a,t)=>e.jsx("li",{children:a},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:["Parede de Vencimentos (Próximos 18 meses)",e.jsx("button",{type:"button",onClick:()=>A("Parede de Vencimentos (Maturity Wall)",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Imagine uma *parede de blocos*, onde cada bloco é o total que você tem a pagar em um determinado mês. Este gráfico mostra quanto de dívida (em parcelas) vence em cada um dos próximos 18 meses."}),e.jsx("p",{className:"mt-2",children:"**Para que serve:** Ajuda a ver se você terá que pagar muito em algum mês específico, para se preparar e não ser pego de surpresa."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Parede de Vencimentos (Maturity Wall)",children:e.jsx(w,{size:16})})]}),e.jsx(Oe,{width:"100%",height:300,children:e.jsxs(_a,{data:Na,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Ea,{strokeDasharray:"3 3"}),e.jsx(Fa,{dataKey:"month"}),e.jsx(Aa,{tickFormatter:a=>y(a*100)}),e.jsx(qe,{formatter:a=>y(a*100)}),e.jsx(Je,{}),e.jsx(za,{dataKey:"value",fill:"#8884d8",name:"PMT Mensal"})]})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:["Concentração por Instituição",e.jsx("button",{type:"button",onClick:()=>A("Concentração por Instituição",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Este gráfico de pizza mostra *para quais bancos você mais deve*. Cada fatia representa um banco e o tamanho da fatia mostra a proporção da sua dívida total com aquele banco."}),e.jsx("p",{className:"mt-2",children:"**Como calculamos:** Somamos o saldo devedor com juros que você tem com cada banco e mostramos a fatia que ele representa no total."}),e.jsx("p",{className:"mt-1",children:"**Para que serve:** Ajuda a ver se você está muito dependente de um único banco, o que pode ser um risco."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Concentração por Instituição",children:e.jsx(w,{size:16})})]}),e.jsx(Oe,{width:"100%",height:300,children:e.jsxs(Ra,{children:[e.jsx(Ia,{data:Se,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:a,percent:t})=>`${a} ${(t*100).toFixed(0)}%`,children:Se.map((a,t)=>e.jsx(Oa,{fill:Be[t%Be.length]},`cell-${t}`))}),e.jsx(qe,{formatter:a=>y(a*100)}),e.jsx(Je,{})]})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow overflow-x-auto",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:["Top 10 Contratos por Saldo",e.jsx("button",{type:"button",onClick:()=>A("Top 10 Contratos por Saldo",e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"Esta é uma tabela com os *10 maiores empréstimos* que você tem, do maior para o menor."}),e.jsx("p",{className:"mt-2",children:"**O que você vê:** Instituição (o banco), Contrato (o número do seu empréstimo), Linha de Crédito (o tipo de empréstimo), Saldo c/ Juros (quanto você ainda deve com juros), Taxa juros % a.m (quanto de juros por mês), PMT Mensal (o valor da parcela mensal), Vencimento Final (quando você termina de pagar)."}),e.jsx("p",{className:"mt-1",children:"**Para que serve:** Ajuda a focar nos empréstimos que mais impactam suas finanças."})]})),className:"ml-2 cursor-pointer text-gray-400 hover:text-gray-700","aria-label":"Explicar Top 10 Contratos por Saldo",children:e.jsx(w,{size:16})})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Instituição"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Contrato"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Linha de Crédito"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Saldo c/ Juros"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Taxa juros % a.m"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"PMT Mensal"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Vencimento Final"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ke.length>0?ke.map((a,t)=>e.jsxs("tr",{className:t%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.instituicao}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.numeroContrato}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.linhaCredito}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y(a.saldoDevedorComJuros*100)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:K(a.taxaJurosMes)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:y(a.valorMensalPMT*100)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(a.vencimentoFinal).toLocaleDateString("pt-BR")})]},t)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"Nenhum contrato encontrado."})})})]})]})]})]})};export{st as default};
