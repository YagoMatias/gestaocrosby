import{r as y,A as f}from"./index-a2563983.js";const B=()=>{const t=y.useCallback(async(a,i={})=>{var n,r,s,c,m,h,v,g,A,j,w,b,q,E,P,x,D,R,T,C,O,S,F;try{const l=new URL(a,f);Object.keys(i).forEach(o=>{const d=i[o];d!=null&&d!==""&&(Array.isArray(d)?d.forEach(u=>l.searchParams.append(o,u)):l.searchParams.append(o,d))}),console.log("ðŸŒ API Call:",l.toString());const p=await fetch(l.toString());if(!p.ok){let o=null;try{o=await p.json()}catch{}const d=o&&(o.message||o.error)||p.statusText||"Erro ao processar requisiÃ§Ã£o";return console.warn("âš ï¸ Resposta nÃ£o OK da API:",{status:p.status,statusText:p.statusText,body:o,url:l.toString()}),{success:!1,faturamentoBazar:u=>t("/api/faturamento/fatbazar",u),total:0,message:d,status:p.status,error:(o==null?void 0:o.error)||null}}const e=await p.json();if(console.log("ðŸ“¦ API Response:",e),console.log("ðŸ“Š API Response Analysis:",{type:typeof e,hasSuccess:"success"in e,hasData:"data"in e,dataType:typeof e.data,isDataArray:Array.isArray(e.data),keys:Object.keys(e)}),e&&typeof e=="object"){if(e.success!==void 0){let o=[];return e.data&&typeof e.data=="object"&&(Array.isArray(e.data.data)?(o=e.data.data,console.log("ðŸ” Detectada estrutura aninhada (data.data)")):e.data.data&&typeof e.data.data=="object"?(o=e.data.data,console.log("ðŸ” Detectada estrutura de objeto aninhado (data.data como objeto)")):Array.isArray(e.data)?(o=e.data,console.log("ðŸ” Detectada estrutura direta (data)")):e.data.groupedData&&Array.isArray(e.data.groupedData)?(o=e.data.groupedData.reduce((d,u)=>u.transactions&&Array.isArray(u.transactions)?d.concat(u.transactions):d,[]),console.log("ðŸ” Detectada estrutura de franquias (data.groupedData)")):typeof e.data=="object"&&!Array.isArray(e.data)&&(o=e.data,console.log("ðŸ” Detectada estrutura de objeto direto"))),console.log("âœ… Processando resposta da nova API:",{originalDataType:typeof e.data,isNestedStructure:e.data&&typeof e.data=="object"&&"data"in e.data,actualDataLength:o.length,isArray:Array.isArray(o),estrutura:e.data&&typeof e.data=="object"?Object.keys(e.data):"N/A"}),{success:e.success,data:o,total:((n=e.data)==null?void 0:n.total)||e.total||o.length,limit:((r=e.data)==null?void 0:r.limit)||e.limit||50,offset:((s=e.data)==null?void 0:s.offset)||e.offset||0,hasMore:((c=e.data)==null?void 0:c.hasMore)||e.hasMore||!1,message:e.message||"",filtros:((m=e.data)==null?void 0:m.filtros)||e.filtros||{},metadata:{count:((h=e.data)==null?void 0:h.count)||e.count,periodo:((v=e.data)==null?void 0:v.periodo)||e.periodo,empresas:((g=e.data)==null?void 0:g.empresas)||e.empresas,estatisticas:((A=e.data)==null?void 0:A.estatisticas)||((j=e.data)==null?void 0:j.totais)||((w=e.data)==null?void 0:w.totals)||e.estatisticas||e.totais||e.totals,totals:((b=e.data)==null?void 0:b.totals)||e.totals,optimized:((q=e.data)==null?void 0:q.optimized)||e.optimized,queryType:((E=e.data)==null?void 0:E.queryType)||e.queryType,operacoes_permitidas:((P=e.data)==null?void 0:P.operacoes_permitidas)||e.operacoes_permitidas,performance:((x=e.data)==null?void 0:x.performance)||e.performance,...e},periodo:((D=e.data)==null?void 0:D.periodo)||e.periodo,empresas:((R=e.data)==null?void 0:R.empresas)||e.empresas,operacoes_permitidas:((T=e.data)==null?void 0:T.operacoes_permitidas)||e.operacoes_permitidas,totals:((C=e.data)==null?void 0:C.totals)||e.totals,optimized:((O=e.data)==null?void 0:O.optimized)||e.optimized,queryType:((S=e.data)==null?void 0:S.queryType)||e.queryType,performance:((F=e.data)==null?void 0:F.performance)||e.performance}}if(e.data&&Array.isArray(e.data))return{success:!0,data:e.data,total:e.total||e.data.length,message:"Dados obtidos com sucesso"};if(e.rows&&Array.isArray(e.rows))return{success:!0,data:e.rows,total:e.total||e.rows.length,message:"Dados obtidos com sucesso"};if(Array.isArray(e))return{success:!0,data:e,total:e.length,message:"Dados obtidos com sucesso"}}return console.warn("âš ï¸ Formato de resposta nÃ£o reconhecido:",e),{success:!1,data:[],total:0,message:"Formato de dados inesperado"}}catch(l){throw console.error("âŒ Erro na API:",l),l}},[]),z=y.useCallback(async(a={})=>{const i=new URL("/api/sales/transacoes-por-operacao",f);Object.keys(a).forEach(r=>{const s=a[r];s!=null&&s!==""&&(Array.isArray(s)?s.forEach(c=>i.searchParams.append(r,c)):i.searchParams.append(r,s))});const n=await fetch(i.toString());if(!n.ok)throw new Error("Erro ao buscar transaÃ§Ãµes da operaÃ§Ã£o");return await n.json()},[]),M=y.useCallback(async(a={})=>{const i=new URL("/api/sales/transacoes-por-nr",f);Object.keys(a).forEach(r=>{const s=a[r];s!=null&&s!==""&&(Array.isArray(s)?s.forEach(c=>i.searchParams.append(r,c)):i.searchParams.append(r,s))});const n=await fetch(i.toString());if(!n.ok)throw new Error("Erro ao buscar itens da transaÃ§Ã£o");return await n.json()},[]);return{apiCall:t,transacoesPorOperacao:z,transacoesPorNr:M,financial:{extrato:a=>t("/api/financial/extrato",a),extratoTotvs:a=>t("/api/financial/extrato-totvs",a),contasPagar:a=>t("/api/financial/contas-pagar",a),contasPagarEmissao:a=>t("/api/financial/contas-pagar-emissao",a),contasReceber:a=>t("/api/financial/contas-receber",a),contasReceberEmissao:a=>t("/api/financial/contas-receberemiss",a),fluxoCaixa:a=>t("/api/financial/fluxo-caixa",a),fluxocaixaSaida:a=>t("/api/financial/fluxo-caixa-saida",a),nfManifestacao:a=>t("/api/financial/nfmanifestacao",a),saldoConta:a=>t("/api/financial/saldo-conta",a),credevAdiantamento:a=>t("/api/financial/credev-adiantamento",a),credevRevenda:a=>t("/api/financial/credev-revenda",a),credevVarejo:a=>t("/api/financial/credev-varejo",a),credevMtm:a=>t("/api/financial/credev-mtm",a),auditorCredev:a=>t("/api/financial/auditor-credev",a),fornecedor:a=>t("/api/financial/fornecedor",a),centrocusto:a=>t("/api/financial/centrocusto",a),despesa:a=>t("/api/financial/despesa",a),inadimplentesMultimarcas:a=>t("/api/financial/inadimplentes-multimarcas",a),inadimplentesFranquias:a=>t("/api/financial/inadimplentes-franquias",a),inadimplentesRevenda:a=>t("/api/financial/inadimplentes-revenda",a),obsFati:a=>t("/api/financial/obsfati",a)},sales:{faturamentoVarejo:a=>t("/api/faturamento/fat-varejo",a),faturamentoMtm:a=>t("/api/faturamento/fat-multimarcas",a),faturamentoBazar:a=>t("/api/faturamento/fatbazar",a),faturamentoFatsellect:a=>t("/api/faturamento/fatsellect",a),faturamentoFranquias:a=>t("/api/faturamento/fat-franquias",a),faturamentoRevenda:a=>t("/api/faturamento/fat-revenda",a),faturamentoConsolidado:a=>t("/api/faturamento/consolidado",a),faturamentoVarejoOld:a=>t("/api/faturamento/varejo",a),faturamentoMtmOld:a=>t("/api/faturamento/mtm",a),faturamentoFranquiasOld:a=>t("/api/faturamento/franquias",a),faturamentoRevendaOld:a=>t("/api/faturamento/revenda",a),cmvVarejo:a=>t("/api/faturamento/cmv-varejo",a),cmvMultimarcas:a=>t("/api/faturamento/cmv-multimarcas",a),cmvFranquias:a=>t("/api/faturamento/cmv-franquias",a),cmvRevenda:a=>t("/api/faturamento/cmv-revenda",a),faturamento:a=>t("/api/sales/faturamento",a),faturamentoFranquia:a=>t("/api/sales/faturamento-franquia",a),receitaliquidaFaturamento:a=>t("/api/sales/receitaliquida-faturamento",a),receitaliquidaFranquias:a=>t("/api/sales/receitaliquida-franquias",a),receitaliquidaMtm:a=>t("/api/sales/receitaliquida-mtm",a),receitaliquidaRevenda:a=>t("/api/sales/receitaliquida-revenda",a),rankingVendedores:a=>t("/api/sales/ranking-vendedores",a),vlimposto:a=>t("/api/sales/vlimposto",a),cmvtest:a=>t("/api/sales/cmvtest",a),cmv:a=>t("/api/sales/cmv",a),dreData:a=>t("/api/sales/dre-data",a),dreDataRaw:async a=>{const i=new URL("/api/sales/dre-data",f);Object.keys(a).forEach(r=>{const s=a[r];s!=null&&s!==""&&(Array.isArray(s)?s.forEach(c=>i.searchParams.append(r,c)):i.searchParams.append(r,s))});const n=await fetch(i.toString());if(!n.ok){let r=null;try{r=await n.json()}catch{}throw new Error(r&&(r.message||r.error)||n.statusText||"Erro ao processar requisiÃ§Ã£o")}return await n.json()},dreCacheClear:()=>t("/api/sales/dre-cache",{},"DELETE"),dreCacheStats:()=>t("/api/sales/dre-cache/stats"),auditoriaTransacoes:async a=>{const i=new URL(`${f}/api/sales/auditoria-transacoes`);Object.keys(a).forEach(s=>{const c=a[s];c!=null&&c!==""&&(Array.isArray(c)?c.forEach(m=>i.searchParams.append(s,m)):i.searchParams.append(s,c))}),console.log("ðŸŒ API Call auditoriaTransacoes:",i.toString());const n=await fetch(i.toString());if(!n.ok){let s=null;try{s=await n.json()}catch{}throw new Error(s&&(s.message||s.error)||n.statusText||"Erro ao processar requisiÃ§Ã£o")}const r=await n.json();return console.log("ðŸ“¦ Auditoria Response:",r),r},impostosPorCanal:a=>t("/api/faturamento/impostos-por-canal",a),impostosDetalhados:a=>t("/api/faturamento/impostos-detalhados",a)},company:{empresas:a=>t("/api/company/empresas",a),grupoEmpresas:a=>t("/api/company/grupo-empresas",a),faturamentoLojas:a=>t("/api/company/faturamento-lojas",a),expedicao:a=>t("/api/company/expedicao",a),pcp:a=>t("/api/company/pcp",a)},franchise:{franquiasCredev:a=>t("/api/franchise/franquias-credev",a)},utils:{health:()=>t("/api/utils/health"),stats:()=>t("/api/utils/stats"),autocompleteFantasia:a=>t("/api/utils/autocomplete/nm_fantasia",{q:a}),autocompleteGrupoEmpresa:a=>t("/api/utils/autocomplete/nm_grupoempresa",{q:a}),cadastroPessoa:a=>t("/api/utils/cadastropessoa",a)}}};export{B as u};
