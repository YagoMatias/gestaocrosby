import{r as o,j as e,P as ie,c as ce}from"./index-a2563983.js";import{m as de}from"./ArrowsClockwise.es-cccb614c.js";import{n as xe}from"./Clock.es-5bd0a93a.js";import{l as b,F as ue}from"./FilterDropdown-c1467603.js";import{u as pe}from"./useApiClient-0bf86fc1.js";import{T as me}from"./Table-ce37d0f3.js";import{utils as A,write as he}from"./xlsx-6ed613d4.js";import{F as fe}from"./FileSaver.min-01e85130.js";import"./Button-3b4dd265.js";import"./CaretUp.es-b369da07.js";import"./CaretUpDown.es-453a995a.js";const ge=({tiposClassificacaoSelecionados:x=[],onSelectTiposClassificacao:l,dadosTipoClassificacao:d=[]})=>{const[i,k]=o.useState(!1),[j,S]=o.useState(""),f=o.useRef(null),v=d.filter(r=>r.toLowerCase().includes(j.toLowerCase())),m=r=>{let c;x.includes(r)?c=x.filter(y=>y!==r):c=[...x,r],l&&l(c)};return o.useEffect(()=>{const r=c=>{f.current&&!f.current.contains(c.target)&&k(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]),e.jsxs("div",{className:"flex flex-col relative",ref:f,children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Tipo Classificação"}),e.jsxs("button",{type:"button",onClick:()=>k(!i),disabled:d.length===0,className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] text-left flex items-center justify-between disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:[e.jsx("span",{className:"truncate",children:d.length===0?"Nenhum tipo disponível":x.length===0?"Selecione os tipos":`${x.length} tipo(s) selecionado(s)`}),d.length===0?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}):e.jsx("svg",{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"w-72 absolute top-full left-0 right-0 z-50 bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-100 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Buscar tipo...",value:j,onChange:r=>S(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#000638] text-sm"})}),e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{l&&l([...d])},className:"text-xs px-2 py-1 bg-[#000638] text-white rounded hover:bg-[#fe0000] transition-colors",children:"Selecionar Todos"}),e.jsx("button",{type:"button",onClick:()=>{l&&l([])},className:"text-xs px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Limpar"})]}),e.jsx("div",{className:"w-full max-h-48 overflow-y-auto",children:d.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum tipo disponível"}):v.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum tipo encontrado"}):v.map(r=>{const c=x.includes(r);return e.jsxs("div",{className:`px-2 py-2 hover:bg-gray-50 cursor-pointer flex items-start mb-1 ${c?"bg-blue-50":""}`,onClick:()=>m(r),children:[e.jsx("div",{className:"flex flex-col flex-1",children:e.jsx("span",{className:"text-xs font-medium text-gray-900",children:r})}),e.jsx("input",{type:"checkbox",checked:c,readOnly:!0,className:"rounded border-gray-300 text-[#000638] focus:ring-[#000638] mr-1 w-4 h-4",onClick:y=>y.stopPropagation()})]},r)})})]})]})},be=({classificacoesSelecionadas:x=[],onSelectClassificacoes:l,dadosClassificacao:d=[]})=>{const[i,k]=o.useState(!1),[j,S]=o.useState(""),f=o.useRef(null),v=d.filter(r=>r.toLowerCase().includes(j.toLowerCase())),m=r=>{let c;x.includes(r)?c=x.filter(y=>y!==r):c=[...x,r],l&&l(c)};return o.useEffect(()=>{const r=c=>{f.current&&!f.current.contains(c.target)&&k(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]),e.jsxs("div",{className:"flex flex-col relative",ref:f,children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Classificação"}),e.jsxs("button",{type:"button",onClick:()=>k(!i),disabled:d.length===0,className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] text-left flex items-center justify-between disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:[e.jsx("span",{className:"truncate",children:d.length===0?"Nenhuma classificação disponível":x.length===0?"Selecione as classificações":`${x.length} classificação(ões) selecionada(s)`}),d.length===0?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}):e.jsx("svg",{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"w-72 absolute top-full left-0 right-0 z-50 bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-100 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Buscar classificação...",value:j,onChange:r=>S(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#000638] text-sm"})}),e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{l&&l([...d])},className:"text-xs px-2 py-1 bg-[#000638] text-white rounded hover:bg-[#fe0000] transition-colors",children:"Selecionar Todas"}),e.jsx("button",{type:"button",onClick:()=>{l&&l([])},className:"text-xs px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Limpar"})]}),e.jsx("div",{className:"w-full max-h-48 overflow-y-auto",children:d.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhuma classificação disponível"}):v.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhuma classificação encontrada"}):v.map(r=>{const c=x.includes(r);return e.jsxs("div",{className:`px-2 py-2 hover:bg-gray-50 cursor-pointer flex items-start mb-1 ${c?"bg-blue-50":""}`,onClick:()=>m(r),children:[e.jsx("div",{className:"flex flex-col flex-1",children:e.jsx("span",{className:"text-xs font-medium text-gray-900",children:r})}),e.jsx("input",{type:"checkbox",checked:c,readOnly:!0,className:"rounded border-gray-300 text-[#000638] focus:ring-[#000638] mr-1 w-4 h-4",onClick:y=>y.stopPropagation()})]},r)})})]})]})},ye=({cdPessoasSelecionados:x=[],onSelectCdPessoas:l,dadosCdPessoa:d=[]})=>{const[i,k]=o.useState(!1),[j,S]=o.useState(""),f=o.useRef(null),v=d.filter(r=>r.toLowerCase().includes(j.toLowerCase())),m=r=>{let c;x.includes(r)?c=x.filter(y=>y!==r):c=[...x,r],l&&l(c)};return o.useEffect(()=>{const r=c=>{f.current&&!f.current.contains(c.target)&&k(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]),e.jsxs("div",{className:"flex flex-col relative",ref:f,children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"CD Pessoa"}),e.jsxs("button",{type:"button",onClick:()=>k(!i),disabled:d.length===0,className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] text-left flex items-center justify-between disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:[e.jsx("span",{className:"truncate",children:d.length===0?"Nenhum código disponível":x.length===0?"Selecione os códigos":`${x.length} código(s) selecionado(s)`}),d.length===0?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}):e.jsx("svg",{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"w-72 absolute top-full left-0 right-0 z-50 bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-100 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Buscar código...",value:j,onChange:r=>S(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#000638] text-sm"})}),e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{l&&l([...d])},className:"text-xs px-2 py-1 bg-[#000638] text-white rounded hover:bg-[#fe0000] transition-colors",children:"Selecionar Todos"}),e.jsx("button",{type:"button",onClick:()=>{l&&l([])},className:"text-xs px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Limpar"})]}),e.jsx("div",{className:"w-full max-h-48 overflow-y-auto",children:d.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum código disponível"}):v.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum código encontrado"}):v.map(r=>{const c=x.includes(r);return e.jsxs("div",{className:`px-2 py-2 hover:bg-gray-50 cursor-pointer flex items-start mb-1 ${c?"bg-blue-50":""}`,onClick:()=>m(r),children:[e.jsx("div",{className:"flex flex-col flex-1",children:e.jsx("span",{className:"text-xs font-medium text-gray-900",children:r})}),e.jsx("input",{type:"checkbox",checked:c,readOnly:!0,className:"rounded border-gray-300 text-[#000638] focus:ring-[#000638] mr-1 w-4 h-4",onClick:y=>y.stopPropagation()})]},r)})})]})]})},je=({nomesPessoaSelecionados:x=[],onSelectNomesPessoa:l,dadosNomePessoa:d=[]})=>{const[i,k]=o.useState(!1),[j,S]=o.useState(""),f=o.useRef(null),v=d.filter(r=>r.toLowerCase().includes(j.toLowerCase())),m=r=>{let c;x.includes(r)?c=x.filter(y=>y!==r):c=[...x,r],l&&l(c)};return o.useEffect(()=>{const r=c=>{f.current&&!f.current.contains(c.target)&&k(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]),e.jsxs("div",{className:"flex flex-col relative",ref:f,children:[e.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Nome Pessoa"}),e.jsxs("button",{type:"button",onClick:()=>k(!i),disabled:d.length===0,className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] text-left flex items-center justify-between disabled:opacity-50 disabled:cursor-not-allowed text-xs",children:[e.jsx("span",{className:"truncate",children:d.length===0?"Nenhum nome disponível":x.length===0?"Selecione os nomes":`${x.length} nome(s) selecionado(s)`}),d.length===0?e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}):e.jsx("svg",{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"w-72 absolute top-full left-0 right-0 z-50 bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-100 overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsx("input",{type:"text",placeholder:"Buscar nome...",value:j,onChange:r=>S(r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#000638] text-sm"})}),e.jsxs("div",{className:"p-3 border-b border-gray-200 bg-gray-50 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{l&&l([...d])},className:"text-xs px-2 py-1 bg-[#000638] text-white rounded hover:bg-[#fe0000] transition-colors",children:"Selecionar Todos"}),e.jsx("button",{type:"button",onClick:()=>{l&&l([])},className:"text-xs px-2 py-1 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Limpar"})]}),e.jsx("div",{className:"w-full max-h-48 overflow-y-auto",children:d.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum nome disponível"}):v.length===0?e.jsx("div",{className:"p-3 text-gray-500 text-sm text-center",children:"Nenhum nome encontrado"}):v.map(r=>{const c=x.includes(r);return e.jsxs("div",{className:`px-2 py-2 hover:bg-gray-50 cursor-pointer flex items-start mb-1 ${c?"bg-blue-50":""}`,onClick:()=>m(r),children:[e.jsx("div",{className:"flex flex-col flex-1",children:e.jsx("span",{className:"text-xs font-medium text-gray-900",children:r})}),e.jsx("input",{type:"checkbox",checked:c,readOnly:!0,className:"rounded border-gray-300 text-[#000638] focus:ring-[#000638] mr-1 w-4 h-4",onClick:y=>y.stopPropagation()})]},r)})})]})]})},Te=()=>{const x=pe(),[l,d]=o.useState({dataInicio:"",dataFim:""}),[i,k]=o.useState([]),[j,S]=o.useState(!1),[f,v]=o.useState(""),[m,r]=o.useState({}),[c,y]=o.useState(null),[N,M]=o.useState(1),[O]=o.useState(50),[C,I]=o.useState("dados");o.useState([]),o.useState([]),o.useState([]),o.useState([]);const V=o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.ds_tipoclas||"").trim()).filter(Boolean))).sort(),[i]),Q=o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.ds_classificacao||"").trim()).filter(Boolean))).sort(),[i]),J=o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.cd_pessoa||"").trim()).filter(Boolean))).sort(),[i]),K=o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.nm_pessoa||"").trim()).filter(Boolean))).sort(),[i]);o.useEffect(()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);d({dataInicio:s.toISOString().split("T")[0],dataFim:a.toISOString().split("T")[0]})},[]);const Y=o.useCallback(async()=>{if(!(!l.dataInicio||!l.dataFim)){S(!0),v("");try{const t={dt_inicio:l.dataInicio,dt_fim:l.dataFim},s=await x.utils.cadastroPessoa(t);s.success?k(s.data||[]):v(s.message||"Erro ao buscar dados")}catch(t){console.error("Erro ao buscar dados:",t),v("Erro ao conectar com o servidor")}finally{S(!1)}}},[l.dataInicio,l.dataFim,x]),q=t=>{t.preventDefault(),Y()},g=o.useCallback(t=>{y(s=>s===t?null:t)},[]),G=o.useCallback((t,s)=>{r(a=>{if(s)return{...a,[t]:s};{const n={...a};return delete n[t],n}})},[]),[_,H]=o.useState([]),[F,X]=o.useState([]),[L,Z]=o.useState([]),[D,ee]=o.useState([]);o.useState(""),o.useState(""),o.useState(""),o.useState("");const[$,te]=o.useState("TODOS");o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.ds_tipoclas||"").trim()).filter(Boolean))).sort(),[i]),o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.ds_classificacao||"").trim()).filter(Boolean))).sort(),[i]),o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.cd_pessoa||"").trim()).filter(Boolean))).sort(),[i]),o.useMemo(()=>Array.from(new Set((i||[]).map(t=>String(t.nm_pessoa||"").trim()).filter(Boolean))).sort(),[i]);const R=o.useMemo(()=>i,[i]),P=o.useMemo(()=>{let t=[...R];if($!=="TODOS"){const a=new Map;R.forEach(n=>{const u=`${n.cd_empresa}-${n.nr_cpfcnpj}`,p=a.get(u)||new Set;n.ds_tipoclas&&p.add(String(n.ds_tipoclas).trim()),a.set(u,p)}),t=t.filter(n=>{const u=`${n.cd_empresa}-${n.nr_cpfcnpj}`,p=(a.get(u)||new Set).size;return $==="UNICO"?p===1:p>1})}_.length>0&&(t=t.filter(a=>_.includes(String(a.ds_tipoclas||"").trim()))),F.length>0&&(t=t.filter(a=>F.includes(String(a.ds_classificacao||"").trim()))),L.length>0&&(t=t.filter(a=>L.includes(String(a.cd_pessoa||"").trim()))),D.length>0&&(t=t.filter(a=>D.includes(String(a.nm_pessoa||"").trim()))),Object.keys(m).forEach(a=>{const n=m[a];n.searchTerm&&(t=t.filter(u=>String(u[a]).toLowerCase().includes(n.searchTerm.toLowerCase()))),n.selected&&n.selected.length>0&&(t=t.filter(u=>n.selected.includes(String(u[a]))))});const s=Object.keys(m).find(a=>{var n;return(n=m[a])==null?void 0:n.sortDirection});if(s){const{sortDirection:a}=m[s];t.sort((n,u)=>{const p=String(n[s]).toLowerCase(),w=String(u[s]).toLowerCase();return a==="asc"?p.localeCompare(w):w.localeCompare(p)})}return t},[R,m,_,F,L,D,$]),W=o.useMemo(()=>{const t=new Map;return R.forEach(s=>{const a=`${s.cd_empresa}-${s.nr_cpfcnpj}`;t.has(a)||t.set(a,{cd_empresa:s.cd_empresa,nr_cpfcnpj:s.nr_cpfcnpj,cd_pessoa:s.cd_pessoa,nm_pessoa:s.nm_pessoa,nm_fantasia:s.nm_fantasia,classificacoes:[]});const n=t.get(a),u=`${s.ds_tipoclas}-${s.ds_classificacao}`;n.classificacoes.some(p=>p.key===u)||n.classificacoes.push({key:u,tipo:s.ds_tipoclas,classificacao:s.ds_classificacao,dt_transacao:s.dt_transacao})}),Array.from(t.values()).map(s=>({...s,totalClassificacoes:s.classificacoes.length}))},[R]),B=o.useMemo(()=>{let t=[...W];L.length>0&&(t=t.filter(a=>L.includes(String(a.cd_pessoa||"").trim()))),D.length>0&&(t=t.filter(a=>D.includes(String(a.nm_pessoa||"").trim()))),_.length>0&&(t=t.filter(a=>(a.classificacoes||[]).some(n=>_.includes(String(n.tipo||"").trim())))),F.length>0&&(t=t.filter(a=>(a.classificacoes||[]).some(n=>F.includes(String(n.classificacao||"").trim())))),$!=="TODOS"&&(t=t.filter(a=>{const n=Array.from(new Set((a.classificacoes||[]).map(u=>String(u.tipo||"").trim())));return $==="UNICO"?n.length===1:n.length>1})),Object.keys(m).forEach(a=>{const n=m[a];n.searchTerm&&(t=t.filter(u=>String(u[a]).toLowerCase().includes(n.searchTerm.toLowerCase()))),n.selected&&n.selected.length>0&&(t=t.filter(u=>n.selected.includes(String(u[a]))))});const s=Object.keys(m).find(a=>{var n;return(n=m[a])==null?void 0:n.sortDirection});if(s){const{sortDirection:a}=m[s];t.sort((n,u)=>{const p=String(n[s]).toLowerCase(),w=String(u[s]).toLowerCase();return a==="asc"?p.localeCompare(w):w.localeCompare(p)})}return t},[W,m,_,F,L,D,$]),se=o.useMemo(()=>{const t=(N-1)*O,s=t+O;return(C==="dados"?P:B).slice(t,s)},[P,B,N,O,C]),z=C==="dados"?P:B,T=Math.ceil(z.length/O),re=(N-1)*O+1,ae=Math.min(N*O,z.length);o.useEffect(()=>{M(1)},[m,i,_,F,L,D,$]),o.useEffect(()=>{const t=document.createElement("style");return t.textContent=`
      .clientes-table {
        font-size: 10px !important;
      }
      .clientes-table th,
      .clientes-table td {
        font-size: 10px !important;
        padding: 4px 6px !important;
        line-height: 1.2 !important;
      }
      .clientes-table th {
        font-weight: 600 !important;
      }
    `,document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]);const U=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString("pt-BR")}catch{return t}},oe=()=>{const t=C==="dados"?P:B;if(!t||t.length===0){alert("Não há dados para exportar.");return}let s;C==="dados"?s=t.map(h=>({"CD Pessoa":h.cd_pessoa??"","Nome Pessoa":h.nm_pessoa??"","Nome Fantasia":h.nm_fantasia??"","CPF/CNPJ":h.nr_cpfcnpj??"",Empresa:h.cd_empresa??"","Tipo Classificação":h.ds_tipoclas??"",Classificação:h.ds_classificacao??"","Data Transação":U(h.dt_transacao)})):s=t.map(h=>({"CD Pessoa":h.cd_pessoa??"","Nome Pessoa":h.nm_pessoa??"","Nome Fantasia":h.nm_fantasia??"","Qtde Classificações":h.totalClassificacoes??0,Tipos:(h.classificacoes||[]).map(E=>E.tipo).join(", "),Classificações:(h.classificacoes||[]).map(E=>E.classificacao).join(", ")}));const a=A.json_to_sheet(s),n=A.book_new();A.book_append_sheet(n,a,C==="dados"?"Dados":"Classificacao");const u=he(n,{bookType:"xlsx",type:"array"}),p=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=new Date().toLocaleDateString("pt-BR").replace(/\//g,"-");fe.saveAs(p,`clientes-${C}-${w}.xlsx`)},ne=[{key:"cd_empresa",title:"Código Empresa",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"nr_cpfcnpj",title:"CPF/CNPJ",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"cd_pessoa",title:"CD Pessoa",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"nm_pessoa",title:"Nome da Pessoa",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"nm_fantasia",title:"Nome Fantasia",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"cd_operacao",title:"Código Operação",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"ds_tipoclas",title:"Descrição Tipo Classificação",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"ds_classificacao",title:"Descrição Classificação",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"dt_transacao",title:"Data Transação",render:t=>U(t),headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})}],le=[{key:"cd_empresa",title:"Código Cliente",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"cd_pessoa",title:"CD Pessoa",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"nm_pessoa",title:"Nome Pessoa",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"nm_fantasia",title:"Nome Fantasia",headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"totalClassificacoes",title:"Total",render:t=>t||0,headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"tiposClassificacao",title:"Tipo Classificação",render:(t,s)=>{const a=s.classificacoes||[];if(a.length===0)return e.jsx("span",{className:"inline-flex items-center gap-x-1.5 py-1.5 px-3 rounded-full text-xs font-medium bg-gray-800 text-white dark:bg-white dark:text-neutral-800",children:"Nenhum"});const n=["bg-indigo-600 text-white","bg-emerald-600 text-white","bg-amber-600 text-white","bg-rose-600 text-white","bg-sky-600 text-white","bg-violet-600 text-white","bg-lime-600 text-white","bg-fuchsia-600 text-white"],u=p=>{const w=Math.abs(String(p).split("").reduce((h,E)=>h+E.charCodeAt(0),0))%n.length;return n[w]};return e.jsx("div",{className:"flex flex-wrap gap-1",children:a.map((p,w)=>e.jsx("span",{className:`inline-flex items-center gap-x-1 py-0.5 px-2 rounded-full text-[10px] font-medium ${u(p.tipo)} dark:bg-white dark:text-neutral-800`,children:p.tipo},w))})},headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})},{key:"classificacoes",title:"Classificação",render:(t,s)=>{const a=s.classificacoes||[];if(a.length===0)return e.jsx("span",{className:"inline-flex items-center gap-x-1.5 py-1.5 px-3 rounded-full text-xs font-medium bg-gray-800 text-white dark:bg-white dark:text-neutral-800",children:"Nenhuma"});const n=["bg-gray-800 text-white","bg-blue-600 text-white","bg-green-600 text-white","bg-yellow-600 text-white","bg-red-600 text-white","bg-cyan-600 text-white","bg-purple-600 text-white","bg-pink-600 text-white"],u=p=>{const w=Math.abs(String(p).split("").reduce((h,E)=>h+E.charCodeAt(0),0))%n.length;return n[w]};return e.jsx("div",{className:"flex flex-wrap gap-1",children:a.map((p,w)=>e.jsx("span",{className:`inline-flex items-center gap-x-1 py-0.5 px-2 rounded-full text-[10px] font-medium ${u(p.classificacao)} dark:bg-white dark:text-neutral-800`,children:p.classificacao},w))})},headerRender:({column:t})=>e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:t.title}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),g(t.key)},className:"text-gray-400 hover:text-gray-700 focus:outline-none focus:text-gray-700","aria-label":`Filtrar por ${t.title}`,children:e.jsx(b,{size:16})})]})}];return e.jsxs("div",{className:"w-full max-w-6xl mx-auto flex flex-col items-stretch justify-start py-8 px-4",children:[e.jsx(ie,{title:"Classificação de Clientes",subtitle:"Análise da classificação de clientes baseado nas transações por período",icon:xe,iconColor:"text-green-600"}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:q,className:"bg-white p-4 rounded-lg shadow-md w-full max-w-4xl mx-auto border border-[#000638]/10",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ce,{size:16,className:"text-[#000638]"}),e.jsx("h2",{className:"text-lg font-bold text-[#000638]",children:"Filtros de Período"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecione o período para análise das transações dos clientes"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-[#000638]",children:"Data Transação Inicial"}),e.jsx("input",{type:"date",name:"dataInicio",value:l.dataInicio,onChange:t=>d({...l,dataInicio:t.target.value}),className:"border border-gray-300 rounded-lg px-2 py-1 w-full focus:outline-none focus:ring-1 focus:ring-[#000638] focus:border-[#000638] bg-white text-[#000638] placeholder:text-gray-400 transition-all duration-200 text-xs",placeholder:"Data inicial"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-[#000638]",children:"Data Transação Final"}),e.jsx("input",{type:"date",name:"dataFim",value:l.dataFim,onChange:t=>d({...l,dataFim:t.target.value}),className:"border border-gray-300 rounded-lg px-2 py-1 w-full focus:outline-none focus:ring-1 focus:ring-[#000638] focus:border-[#000638] bg-white text-[#000638] placeholder:text-gray-400 transition-all duration-200 text-xs",placeholder:"Data final"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-[#000638]",children:"Quantidade de Tipos"}),e.jsxs("select",{value:$,onChange:t=>te(t.target.value),className:"border border-gray-300 rounded-lg px-2 py-1 w-full text-xs bg-white",children:[e.jsx("option",{value:"TODOS",children:"TODOS"}),e.jsx("option",{value:"UNICO",children:"ÚNICO"}),e.jsx("option",{value:"MULTIPLOS",children:"MÚLTIPLOS"})]})]}),e.jsx("div",{className:"flex flex-col",children:e.jsx(ge,{tiposClassificacaoSelecionados:_,onSelectTiposClassificacao:H,dadosTipoClassificacao:V})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(be,{classificacoesSelecionadas:F,onSelectClassificacoes:X,dadosClassificacao:Q})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(ye,{cdPessoasSelecionados:L,onSelectCdPessoas:Z,dadosCdPessoa:J})}),e.jsx("div",{className:"flex flex-col",children:e.jsx(je,{nomesPessoaSelecionados:D,onSelectNomesPessoa:ee,dadosNomePessoa:K})}),e.jsx("div",{className:"flex flex-col justify-center",children:e.jsx("button",{type:"submit",disabled:j,className:"flex items-center justify-center gap-1 bg-[#000638] text-white px-3 py-1.5 rounded-md hover:bg-[#001060] transition-all duration-200 text-xs font-semibold shadow hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Filtrando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{size:16,weight:"bold"}),"Filtrar Dados"]})})})]})]})}),Object.keys(m).length>0&&e.jsx("div",{className:"mb-4 text-right",children:e.jsxs("button",{onClick:()=>r({}),className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 transition-colors",children:[e.jsx(b,{size:14}),"Limpar Filtros"]})}),e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-1 flex",children:[e.jsx("button",{onClick:()=>I("dados"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 ${C==="dados"?"bg-white text-[#000638] shadow-sm":"text-gray-600 hover:text-[#000638]"}`,children:"DADOS CLIENTES"}),e.jsx("button",{onClick:()=>I("classificacao"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all duration-200 ${C==="classificacao"?"bg-white text-[#000638] shadow-sm":"text-gray-600 hover:text-[#000638]"}`,children:"CLASSIFICAÇÃO CLIENTES"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#000638]",children:C==="dados"?"Dados dos Clientes":"Classificação dos Clientes"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Período: ",l.dataInicio," até ",l.dataFim,i.length>0&&e.jsxs("span",{className:"ml-2 text-blue-600 font-medium",children:["Mostrando ",re,"-",ae," de ",z.length," ","registros",z.length!==i.length&&` (${i.length} total)`]})]}),z.length>0&&e.jsx("button",{onClick:oe,className:"text-xs px-3 py-1.5 rounded-md bg-green-600 text-white hover:bg-green-700",title:"Baixar Excel dos dados filtrados",children:"Baixar Excel"})]})]}),f&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:f}),j?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#000638]"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Carregando dados..."})]}):z.length>0?e.jsxs(e.Fragment,{children:[e.jsx(me,{data:se,rowKey:(t,s)=>`${t.cd_empresa}-${t.nr_cpfcnpj}-${s}`,containerClassName:"clientes-table",className:"clientes-table",columns:(C==="dados"?ne:le).map(t=>({...t,headerRender:({column:s})=>e.jsxs("div",{className:"relative flex items-center space-x-1",children:[e.jsx("span",{children:s.title}),e.jsx("button",{type:"button",onClick:a=>{a.stopPropagation(),g(s.key)},className:`hover:text-gray-700 focus:outline-none focus:text-gray-700 ${m[s.key]?"text-blue-600":"text-gray-400"}`,"aria-label":`Filtrar por ${s.title}`,children:e.jsx(b,{size:16})}),c===s.key&&e.jsx(ue,{columnKey:s.key,columnTitle:s.title,data:P,currentFilter:m[s.key],onApplyFilter:G,onClose:()=>g(null)})]})})),emptyMessage:"Nenhum cliente encontrado para o período selecionado"}),T>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 px-4 py-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>M(1),disabled:N===1,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Primeira"}),e.jsx("button",{onClick:()=>M(N-1),disabled:N===1,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"})]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,T)},(t,s)=>{let a;return T<=5||N<=3?a=s+1:N>=T-2?a=T-4+s:a=N-2+s,e.jsx("button",{onClick:()=>M(a),className:`px-3 py-1 text-sm border rounded ${N===a?"bg-[#000638] text-white border-[#000638]":"border-gray-300 hover:bg-gray-100"}`,children:a},a)})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>M(N+1),disabled:N===T,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Próxima"}),e.jsx("button",{onClick:()=>M(T),disabled:N===T,className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Última"})]})]})]}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:i.length===0?"Nenhum cliente encontrado para o período selecionado":"Nenhum cliente corresponde aos filtros aplicados"})]})]})};export{Te as default};
