import{r as t,h as C,j as e,n as k,d as u,u as M,y as D,i as z,z as N,B as y,C as P}from"./index-a2563983.js";import{s as i}from"./XCircle.es-fcbde856.js";import{u as H,b as F}from"./userProfiles-2dc3ab72.js";const I=new Map([["bold",t.createElement(t.Fragment,null,t.createElement("path",{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"}))],["duotone",t.createElement(t.Fragment,null,t.createElement("path",{d:"M112,56V200L40,128Z",opacity:"0.2"}),t.createElement("path",{d:"M216,120H120V56a8,8,0,0,0-13.66-5.66l-72,72a8,8,0,0,0,0,11.32l72,72A8,8,0,0,0,120,200V136h96a8,8,0,0,0,0-16ZM104,180.69,51.31,128,104,75.31Z"}))],["fill",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H120v64a8,8,0,0,1-13.66,5.66l-72-72a8,8,0,0,1,0-11.32l72-72A8,8,0,0,1,120,56v64h96A8,8,0,0,1,224,128Z"}))],["light",t.createElement(t.Fragment,null,t.createElement("path",{d:"M222,128a6,6,0,0,1-6,6H54.49l61.75,61.76a6,6,0,1,1-8.48,8.48l-72-72a6,6,0,0,1,0-8.48l72-72a6,6,0,0,1,8.48,8.48L54.49,122H216A6,6,0,0,1,222,128Z"}))],["regular",t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,128a8,8,0,0,1-8,8H59.31l58.35,58.34a8,8,0,0,1-11.32,11.32l-72-72a8,8,0,0,1,0-11.32l72-72a8,8,0,0,1,11.32,11.32L59.31,120H216A8,8,0,0,1,224,128Z"}))],["thin",t.createElement(t.Fragment,null,t.createElement("path",{d:"M220,128a4,4,0,0,1-4,4H49.66l65.17,65.17a4,4,0,0,1-5.66,5.66l-72-72a4,4,0,0,1,0-5.66l72-72a4,4,0,0,1,5.66,5.66L49.66,124H216A4,4,0,0,1,220,128Z"}))]]),E=t.forwardRef((a,c)=>t.createElement(C,{ref:c,...a,weights:I}));E.displayName="ArrowLeftIcon";const T=E,Z=({message:a,type:c="success",duration:g=5e3,onClose:d})=>{const[h,m]=t.useState(!0);t.useEffect(()=>{const o=setTimeout(()=>{m(!1),setTimeout(()=>d(),300)},g);return()=>clearTimeout(o)},[g,d]);const x=()=>{switch(c){case"success":return e.jsx(u,{size:20,className:"text-green-600"});case"error":return e.jsx(i,{size:20,className:"text-red-600"});default:return e.jsx(u,{size:20,className:"text-blue-600"})}},s=()=>{switch(c){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";default:return"bg-blue-50 border-blue-200"}},f=()=>{switch(c){case"success":return"text-green-800";case"error":return"text-red-800";default:return"text-blue-800"}};return e.jsx("div",{className:`fixed top-4 right-4 z-50 transform transition-all duration-300 ${h?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:e.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-lg border shadow-lg ${s()}`,children:[x(),e.jsx("span",{className:`font-medium ${f()}`,children:a}),e.jsx("button",{onClick:()=>{m(!1),setTimeout(()=>d(),300)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(k,{size:16})})]})})},U=()=>{const{user:a,setUser:c}=M(),g=D(),[d,h]=t.useState(!1),[m,x]=t.useState(null),[s,f]=t.useState({name:(a==null?void 0:a.name)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[o,S]=t.useState({current:!1,new:!1,confirm:!1}),[n,v]=t.useState({}),w=r=>{const{name:l,value:b}=r.target;f(j=>({...j,[l]:b})),n[l]&&v(j=>({...j,[l]:""}))},p=r=>{S(l=>({...l,[r]:!l[r]}))},$=()=>{const r={};return s.name.trim()?s.name.trim().length<2&&(r.name="Nome deve ter pelo menos 2 caracteres"):r.name="Nome é obrigatório",(s.newPassword||s.confirmPassword||s.currentPassword)&&(s.currentPassword||(r.currentPassword="Senha atual é obrigatória"),s.newPassword?s.newPassword.length<6&&(r.newPassword="A nova senha deve ter pelo menos 6 caracteres"):r.newPassword="Nova senha é obrigatória",s.confirmPassword?s.newPassword!==s.confirmPassword&&(r.confirmPassword="As senhas não coincidem"):r.confirmPassword="Confirmação de senha é obrigatória",s.currentPassword===s.newPassword&&(r.newPassword="A nova senha deve ser diferente da senha atual")),v(r),Object.keys(r).length===0},A=async r=>{if(r.preventDefault(),!!$()){h(!0);try{s.name!==a.name&&await H(a.id,{name:s.name}),s.newPassword&&await F(a.id,s.currentPassword,s.newPassword);const l={...a,name:s.name};c(l),localStorage.setItem("user",JSON.stringify(l)),f(b=>({...b,currentPassword:"",newPassword:"",confirmPassword:""})),x({message:"Dados atualizados com sucesso!",type:"success"})}catch(l){x({message:`Erro ao atualizar dados: ${l.message}`,type:"error"})}finally{h(!1)}}};return e.jsxs("div",{className:"w-full max-w-2xl mx-auto flex flex-col items-stretch justify-start py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>g(-1),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Voltar",children:e.jsx(T,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Painel do Usuário"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie suas informações pessoais"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(z,{size:32,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-gray-600",children:a==null?void 0:a.email}),e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ${(a==null?void 0:a.role)==="ADM"?"bg-red-100 text-red-800":(a==null?void 0:a.role)==="DIRETOR"?"bg-blue-100 text-blue-800":(a==null?void 0:a.role)==="FINANCEIRO"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:a==null?void 0:a.role})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Editar Informações"}),e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"name",value:s.name,onChange:w,className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.name?"border-red-300":"border-gray-300"}`,placeholder:"Digite seu nome completo"}),e.jsx(z,{size:20,className:"absolute left-3 top-2.5 text-gray-400"})]}),n.name&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center gap-1",children:[e.jsx(i,{size:16}),n.name]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-4",children:"Alterar Senha (opcional)"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha Atual"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o.current?"text":"password",name:"currentPassword",value:s.currentPassword,onChange:w,className:`w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.currentPassword?"border-red-300":"border-gray-300"}`,placeholder:"Digite sua senha atual"}),e.jsx(N,{size:20,className:"absolute left-3 top-2.5 text-gray-400"}),e.jsx("button",{type:"button",onClick:()=>p("current"),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:o.current?e.jsx(y,{size:20}):e.jsx(P,{size:20})})]}),n.currentPassword&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center gap-1",children:[e.jsx(i,{size:16}),n.currentPassword]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o.new?"text":"password",name:"newPassword",value:s.newPassword,onChange:w,className:`w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.newPassword?"border-red-300":"border-gray-300"}`,placeholder:"Digite sua nova senha"}),e.jsx(N,{size:20,className:"absolute left-3 top-2.5 text-gray-400"}),e.jsx("button",{type:"button",onClick:()=>p("new"),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:o.new?e.jsx(y,{size:20}):e.jsx(P,{size:20})})]}),n.newPassword&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center gap-1",children:[e.jsx(i,{size:16}),n.newPassword]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:o.confirm?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:w,className:`w-full pl-10 pr-10 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.confirmPassword?"border-red-300":"border-gray-300"}`,placeholder:"Confirme sua nova senha"}),e.jsx(N,{size:20,className:"absolute left-3 top-2.5 text-gray-400"}),e.jsx("button",{type:"button",onClick:()=>p("confirm"),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:o.confirm?e.jsx(y,{size:20}):e.jsx(P,{size:20})})]}),n.confirmPassword&&e.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center gap-1",children:[e.jsx(i,{size:16}),n.confirmPassword]})]}),(s.newPassword||s.confirmPassword)&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Requisitos da senha:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("li",{className:`flex items-center gap-1 ${s.newPassword.length>=6?"text-green-600":""}`,children:[s.newPassword.length>=6?e.jsx(u,{size:12}):e.jsx(i,{size:12}),"Mínimo de 6 caracteres"]}),e.jsxs("li",{className:`flex items-center gap-1 ${s.newPassword!==s.currentPassword?"text-green-600":""}`,children:[s.newPassword&&s.newPassword!==s.currentPassword?e.jsx(u,{size:12}):e.jsx(i,{size:12}),"Diferente da senha atual"]}),e.jsxs("li",{className:`flex items-center gap-1 ${s.newPassword===s.confirmPassword&&s.confirmPassword?"text-green-600":""}`,children:[s.newPassword===s.confirmPassword&&s.confirmPassword?e.jsx(u,{size:12}):e.jsx(i,{size:12}),"Senhas coincidem"]})]})]})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors",children:d?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Salvando..."]}):"Salvar Alterações"})]})]}),m&&e.jsx(Z,{message:m.message,type:m.type,onClose:()=>x(null)})]})};export{U as default};
