import{r as u,j as a,P as ha,p as H,L as _a,$ as pa,b as fa,g as ga,m as ja}from"./index-a2563983.js";import{u as Na}from"./useApiClient-0bf86fc1.js";import{C as h,a as _,b as p,c as f,d as N}from"./cards-fd94db0b.js";import{C as qa,a as ya,L as Fa,B as wa,p as Ca,b as Da,c as Ma,A as za,h as Ba,l as Ea,P as I}from"./index-d0e9a633.js";import{p as Sa}from"./chartjs-plugin-datalabels.esm-5b853c4b.js";import{c as Aa}from"./ArrowDown.es-b2258871.js";import{s as ia}from"./ArrowUp.es-3ccbaccd.js";import{s as O}from"./ChartPieSlice.es-9a55dc44.js";import{s as ka}from"./Funnel.es-cd3339ac.js";qa.register(ya,Fa,wa,Ca,Da,Ma,za,Ba,Ea,Sa);const Wa=()=>{var aa,ea,sa,ta,oa,la,ra,da;const b=Na(),[v,B]=u.useState(null),G=new Date,ca=new Date(G.getFullYear(),G.getMonth(),1),[E,ma]=u.useState(ca.toISOString().split("T")[0]),[S,xa]=u.useState(G.toISOString().split("T")[0]),[F,ua]=u.useState({varejo:[],mtm:[],franquias:[],revenda:[],bazar:[],fatsellect:[]}),[K,ba]=u.useState({varejo:[],mtm:[],franquias:[],revenda:[],bazar:[],fatsellect:[]}),[Y,J]=u.useState(!1),[Q,W]=u.useState(""),m=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(s||0),va=async()=>{if(!E||!S){W("Por favor, selecione as datas de in√≠cio e fim");return}J(!0),W("");try{const s={dataInicio:E,dataFim:S},l=new Date(E),e=new Date(S),t=new Date(l);t.setMonth(t.getMonth()-1);const r=new Date(e);r.setMonth(r.getMonth()-1);const d={...s,dataInicio:t.toISOString().split("T")[0],dataFim:r.toISOString().split("T")[0]};console.log("Per√≠odo atual:",E,"at√©",S),console.log("Per√≠odo anterior calculado:",d.dataInicio,"at√©",d.dataFim),console.log("Params atual:",s),console.log("Params anterior:",d);const[n,i,c,x,g,j]=await Promise.all([b.sales.faturamentoVarejo(s),b.sales.faturamentoMtm(s),b.sales.faturamentoFranquias(s),b.sales.faturamentoRevenda(s),b.sales.faturamentoBazar(s),b.sales.faturamentoFatsellect(s)]),[y,q,w,C,M,z]=await Promise.all([b.sales.faturamentoVarejo(d),b.sales.faturamentoMtm(d),b.sales.faturamentoFranquias(d),b.sales.faturamentoRevenda(d),b.sales.faturamentoBazar(d),b.sales.faturamentoFatsellect(d)]);console.log("üìä Dados Varejo recebidos:",n),console.log("üìä Dados MTM recebidos:",i),console.log("üìä Dados Franquias recebidos:",c),console.log("üìä Dados Revenda recebidos:",x);const k=n.data||[],R=i.data||[],L=c.data||[],T=x.data||[],V=g.data||[],$=j.data||[];console.log("üìä Dados Varejo extra√≠dos:",k),console.log("üìä Dados MTM extra√≠dos:",R),console.log("üìä Dados Franquias extra√≠dos:",L),console.log("üìä Dados Revenda extra√≠dos:",T),ua({varejo:k,mtm:R,franquias:L,revenda:T,bazar:V,fatsellect:$}),ba({varejo:y.data||[],mtm:q.data||[],franquias:w.data||[],revenda:C.data||[],bazar:M.data||[],fatsellect:z.data||[]})}catch(s){console.error("Erro ao buscar dados:",s),W("Erro ao carregar dados de faturamento")}finally{J(!1)}},o=u.useMemo(()=>{const s=["varejo","mtm","franquias","revenda","bazar","fatsellect"],l={};return s.forEach(e=>{const t=F[e]||[];console.log(`üìä Processando ${e}:`,t),l[e]=t.reduce((r,d)=>{const n=parseFloat(d.valor_sem_desconto_saida)||0,i=parseFloat(d.valor_sem_desconto_entrada)||0,c=parseFloat(d.valor_sem_desconto)||0,x=parseFloat(d.valor_com_desconto_saida)||0,g=parseFloat(d.valor_com_desconto_entrada)||0,j=parseFloat(d.valor_com_desconto)||0,y=n-x,q=i-g,w=c-j,C=parseFloat(d.cmv)||0,M=parseFloat(d.quantidade_total_saida)||0,z=parseFloat(d.quantidade_total_entrada)||0;return(n>0||x>0||C>0)&&console.log(`  Item ${e}:`,{valorBrutoSaida:n,valorLiquidoSaida:x,valorBrutoEntrada:i,valorLiquidoEntrada:g,valorBrutoTotal:c,valorLiquidoTotal:j,descontoTotal:w,cmv:C,qtdSaida:M,qtdEntrada:z}),{valor_bruto_saida:r.valor_bruto_saida+n,valor_liquido_saida:r.valor_liquido_saida+x,desconto_saida:r.desconto_saida+y,valor_bruto_entrada:r.valor_bruto_entrada+i,valor_liquido_entrada:r.valor_liquido_entrada+g,desconto_entrada:r.desconto_entrada+q,valor_bruto_total:r.valor_bruto_total+c,valor_liquido_total:r.valor_liquido_total+j,desconto_total:r.desconto_total+w,quantidade_saida:r.quantidade_saida+(parseFloat(d.quantidade_total_saida)||0),quantidade_entrada:r.quantidade_entrada+(parseFloat(d.quantidade_total_entrada)||0),cmv:r.cmv+(parseFloat(d.cmv)||0)}},{valor_bruto_saida:0,valor_liquido_saida:0,desconto_saida:0,valor_bruto_entrada:0,valor_liquido_entrada:0,desconto_entrada:0,valor_bruto_total:0,valor_liquido_total:0,desconto_total:0,quantidade_saida:0,quantidade_entrada:0,cmv:0}),console.log(`üìä Resultado consolidado para ${e}:`,l[e])}),l.totais=s.reduce((e,t)=>({valor_bruto_saida:e.valor_bruto_saida+l[t].valor_bruto_saida,valor_liquido_saida:e.valor_liquido_saida+l[t].valor_liquido_saida,desconto_saida:e.desconto_saida+l[t].desconto_saida,valor_bruto_entrada:e.valor_bruto_entrada+l[t].valor_bruto_entrada,valor_liquido_entrada:e.valor_liquido_entrada+l[t].valor_liquido_entrada,desconto_entrada:e.desconto_entrada+l[t].desconto_entrada,valor_bruto_total:e.valor_bruto_total+l[t].valor_bruto_total,valor_liquido_total:e.valor_liquido_total+l[t].valor_liquido_total,desconto_total:e.desconto_total+l[t].desconto_total,quantidade_saida:e.quantidade_saida+l[t].quantidade_saida,quantidade_entrada:e.quantidade_entrada+l[t].quantidade_entrada,cmv:e.cmv+l[t].cmv}),{valor_bruto_saida:0,valor_liquido_saida:0,desconto_saida:0,valor_bruto_entrada:0,valor_liquido_entrada:0,desconto_entrada:0,valor_bruto_total:0,valor_liquido_total:0,desconto_total:0,quantidade_saida:0,quantidade_entrada:0,cmv:0}),l},[F]),U=u.useMemo(()=>{const s=["varejo","mtm","franquias","revenda","bazar","fatsellect"],l={};return s.forEach(e=>{const t=K[e]||[];l[e]=t.reduce((r,d)=>{const n=parseFloat(d.valor_sem_desconto)||0,i=parseFloat(d.valor_com_desconto)||0,c=n-i;return{valor_bruto_total:r.valor_bruto_total+n,valor_liquido_total:r.valor_liquido_total+i,desconto_total:r.desconto_total+c}},{valor_bruto_total:0,valor_liquido_total:0,desconto_total:0})}),l},[K]),D=u.useMemo(()=>{var e,t,r,d,n,i;const s=["Varejo","MTM","Franquias","Revenda","Bazar","Sellect"],l=[((e=o.varejo)==null?void 0:e.valor_liquido_total)||0,((t=o.mtm)==null?void 0:t.valor_liquido_total)||0,((r=o.franquias)==null?void 0:r.valor_liquido_total)||0,((d=o.revenda)==null?void 0:d.valor_liquido_total)||0,((n=o.bazar)==null?void 0:n.valor_liquido_total)||0,((i=o.fatsellect)==null?void 0:i.valor_liquido_total)||0];return{labels:s,datasets:[{data:l,backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#6366F1","#06B6D4"],borderWidth:2,borderColor:"#fff"}]}},[o]),A=u.useMemo(()=>{var e,t,r,d,n,i;const s=["Varejo","Multimarcas","Franquias","Revenda","Bazar","Sellect"],l=[Math.abs(((e=o.varejo)==null?void 0:e.valor_liquido_entrada)||0),Math.abs(((t=o.mtm)==null?void 0:t.valor_liquido_entrada)||0),Math.abs(((r=o.franquias)==null?void 0:r.valor_liquido_entrada)||0),Math.abs(((d=o.revenda)==null?void 0:d.valor_liquido_entrada)||0),Math.abs(((n=o.bazar)==null?void 0:n.valor_liquido_entrada)||0),Math.abs(((i=o.fatsellect)==null?void 0:i.valor_liquido_entrada)||0)];return{labels:s,datasets:[{data:l,backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#6366F1","#06B6D4"],borderWidth:2,borderColor:"#fff"}]}},[o]);u.useMemo(()=>{var l,e,t,r,d,n,i,c,x,g,j,y,q,w,C,M,z,k,R,L,T,V,$,na;return{labels:["Varejo","MTM","Franquias","Revenda","Bazar","Fatsellect"],datasets:[{label:"Valor Bruto (Sa√≠da)",data:[((l=o.varejo)==null?void 0:l.valor_bruto_saida)||0,((e=o.mtm)==null?void 0:e.valor_bruto_saida)||0,((t=o.franquias)==null?void 0:t.valor_bruto_saida)||0,((r=o.revenda)==null?void 0:r.valor_bruto_saida)||0,((d=o.bazar)==null?void 0:d.valor_bruto_saida)||0,((n=o.fatsellect)==null?void 0:n.valor_bruto_saida)||0],backgroundColor:"#3B82F6"},{label:"Valor L√≠quido (Sa√≠da)",data:[((i=o.varejo)==null?void 0:i.valor_liquido_saida)||0,((c=o.mtm)==null?void 0:c.valor_liquido_saida)||0,((x=o.franquias)==null?void 0:x.valor_liquido_saida)||0,((g=o.revenda)==null?void 0:g.valor_liquido_saida)||0,((j=o.bazar)==null?void 0:j.valor_liquido_saida)||0,((y=o.fatsellect)==null?void 0:y.valor_liquido_saida)||0],backgroundColor:"#10B981"},{label:"Descontos Dados",data:[((q=o.varejo)==null?void 0:q.desconto_saida)||0,((w=o.mtm)==null?void 0:w.desconto_saida)||0,((C=o.franquias)==null?void 0:C.desconto_saida)||0,((M=o.revenda)==null?void 0:M.desconto_saida)||0,((z=o.bazar)==null?void 0:z.desconto_saida)||0,((k=o.fatsellect)==null?void 0:k.desconto_saida)||0],backgroundColor:"#F59E0B"},{label:"Devolu√ß√µes (Entrada)",data:[Math.abs(((R=o.varejo)==null?void 0:R.valor_liquido_entrada)||0),Math.abs(((L=o.mtm)==null?void 0:L.valor_liquido_entrada)||0),Math.abs(((T=o.franquias)==null?void 0:T.valor_liquido_entrada)||0),Math.abs(((V=o.revenda)==null?void 0:V.valor_liquido_entrada)||0),Math.abs((($=o.bazar)==null?void 0:$.valor_liquido_entrada)||0),Math.abs(((na=o.fatsellect)==null?void 0:na.valor_liquido_entrada)||0)],backgroundColor:"#EF4444"}]}},[o]),u.useMemo(()=>{const s=new Map;Object.keys(F).forEach(e=>{F[e].forEach(t=>{const r=t.cd_grupoempresa||t.cd_empresa;s.has(r)||s.set(r,{empresa:r,nm_grupoempresa:t.nm_grupoempresa||r,varejo:0,mtm:0,franquias:0,revenda:0,bazar:0,fatsellect:0});const d=parseFloat(t.valor_com_desconto_saida)||0,n=parseFloat(t.valor_com_desconto_entrada)||0,i=d-Math.abs(n);s.get(r)[e]+=i})});const l=Array.from(s.values()).sort((e,t)=>e.empresa-t.empresa);return{labels:l.map(e=>e.nm_grupoempresa||`Grupo ${e.empresa}`),datasets:[{label:"Varejo",data:l.map(e=>e.varejo),borderColor:"#3B82F6",backgroundColor:"#3B82F6",tension:.1},{label:"MTM",data:l.map(e=>e.mtm),borderColor:"#10B981",backgroundColor:"#10B981",tension:.1},{label:"Franquias",data:l.map(e=>e.franquias),borderColor:"#F59E0B",backgroundColor:"#F59E0B",tension:.1},{label:"Revenda",data:l.map(e=>e.revenda),borderColor:"#EF4444",backgroundColor:"#EF4444",tension:.1},{label:"Fatsellect",data:l.map(e=>e.fatsellect),borderColor:"#06B6D4",backgroundColor:"#06B6D4",tension:.1}]}},[F]);const P={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:function(s){const l=s.dataset.data.reduce((t,r)=>t+r,0),e=l>0?(s.raw/l*100).toFixed(1):"0.0";return`${s.label}: ${m(s.raw)} (${e}%)`}}},datalabels:{display:!0,color:"#ffffff",font:{weight:"bold",size:12},formatter:function(s,l){const t=l.dataset.data.reduce((d,n)=>d+n,0);return(t>0?(s/t*100).toFixed(1):"0.0")+"%"}}}},X="valor_liquido_total",Z=s=>{var n,i;const l=((n=o[s])==null?void 0:n[X])||0,e=((i=U[s])==null?void 0:i[X])||0,t=l-e,r=e!==0?l/Math.abs(e):null,d=e!==0?(l-e)/Math.abs(e)*100:null;return e<0?{swing:t,multiplicador:r,variacao:d,anterior:e,atual:l}:e===0?{swing:t,multiplicador:null,variacao:null,anterior:e,atual:l}:{swing:t,multiplicador:r,variacao:(l-e)/e*100,anterior:e,atual:l}};return u.useMemo(()=>{const s=Object.keys(o).filter(e=>e!=="totais"),l=s.map(e=>Z(e));return console.log("Dados consolidados atual:",o),console.log("Dados consolidados m√™s anterior:",U),console.log("Crescimentos calculados:",l),{labels:s.map(e=>e.charAt(0).toUpperCase()+e.slice(1)),datasets:[{label:"Taxa de Crescimento (%)",data:l,backgroundColor:l.map(e=>e>=0?"#10B981":"#EF4444"),borderColor:l.map(e=>e>=0?"#059669":"#DC2626"),borderWidth:2}]}},[o,U]),a.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4",children:[a.jsx(ha,{title:"Dashboard Faturamento",subtitle:"An√°lise completa e gerencial dos dados de faturamento das lojas",icon:H,iconColor:"text-indigo-600"}),a.jsx("div",{className:"mb-4",children:a.jsxs("form",{className:"flex flex-col bg-white p-3 rounded-lg shadow-lg w-full max-w-4xl mx-auto border border-[#000638]/10 gap-5 p-5",children:[a.jsxs("div",{className:"mb-2",children:[a.jsxs("span",{className:"text-lg font-bold text-[#000638] flex items-center gap-1",children:[a.jsx(ka,{size:18,weight:"bold"}),"Filtros"]}),a.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Selecione o per√≠odo e empresa para an√°lise"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5 mb-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Data In√≠cio"}),a.jsx("input",{type:"date",value:E,onChange:s=>ma(s.target.value),className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] placeholder:text-gray-400 text-xs"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-semibold mb-0.5 text-[#000638]",children:"Data Fim"}),a.jsx("input",{type:"date",value:S,onChange:s=>xa(s.target.value),className:"border border-[#000638]/30 rounded-lg px-2 py-1.5 w-full focus:outline-none focus:ring-2 focus:ring-[#000638] bg-[#f8f9fb] text-[#000638] placeholder:text-gray-400 text-xs"})]}),a.jsx("div",{className:"mt-4 flex gap-2",children:a.jsx("button",{onClick:va,disabled:Y,className:"flex items-center gap-1 bg-[#000638] text-white px-3 py-1 rounded-lg hover:bg-[#fe0000] disabled:opacity-50 disabled:cursor-not-allowed font-medium transition-colors h-7 text-xs font-bold shadow-md tracking-wide uppercase",children:a.jsxs(a.Fragment,{children:[a.jsx(H,{size:16}),"Buscar Dados"]})})})]})]})}),Q&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md mb-6",children:Q}),Y?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(_a,{})}):Object.values(F).some(s=>s.length>0)?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white cursor-pointer",onClick:()=>B({tipo:"canal",title:"Distribui√ß√£o do Faturamento por Canal",data:D}),children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pa,{size:18,className:"text-blue-600"}),a.jsx(p,{className:"text-sm font-bold text-blue-700",children:"Faturamento Bruto Total"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-blue-600 mb-0.5",children:m((aa=o.totais)==null?void 0:aa.valor_bruto_total)}),a.jsx(N,{className:"text-xs text-gray-500",children:"Sem descontos"})]})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fa,{size:18,className:"text-green-600"}),a.jsx(p,{className:"text-sm font-bold text-green-700",children:"Faturamento L√≠quido Total"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-green-600 mb-0.5",children:m((ea=o.totais)==null?void 0:ea.valor_liquido_total)}),a.jsx(N,{className:"text-xs text-gray-500",children:"Com descontos"})]})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ga,{size:18,className:"text-orange-600"}),a.jsx(p,{className:"text-sm font-bold text-orange-700",children:"Descontos Dados"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-orange-600 mb-0.5",children:m((sa=o.totais)==null?void 0:sa.desconto_total)}),a.jsx(N,{className:"text-xs text-gray-500",children:"Total de descontos"})]})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{size:18,className:"text-blue-600"}),a.jsx(p,{className:"text-sm font-bold text-blue-700",children:"Receita Bruta"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-blue-600 mb-0.5",children:m(((ta=o.totais)==null?void 0:ta.valor_bruto_saida)-((oa=o.totais)==null?void 0:oa.valor_bruto_entrada))}),a.jsx(N,{className:"text-xs text-gray-500",children:"Sa√≠da - Entrada com descontos"})]})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ia,{size:18,className:"text-green-600"}),a.jsx(p,{className:"text-sm font-bold text-green-700",children:"Receita L√≠quida"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-green-600 mb-0.5",children:m(((la=o.totais)==null?void 0:la.valor_liquido_saida)-Math.abs((ra=o.totais)==null?void 0:ra.valor_liquido_entrada))}),a.jsx(N,{className:"text-xs text-gray-500",children:"Sa√≠das - Entradas sem desconto"})]})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Aa,{size:18,className:"text-red-600"}),a.jsx(p,{className:"text-sm font-bold text-red-700",children:"Devolu√ß√µes"})]})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:"text-base font-extrabold text-red-600 mb-0.5",children:m(Math.abs((da=o.totais)==null?void 0:da.valor_liquido_entrada))}),a.jsx(N,{className:"text-xs text-gray-500",children:"Valores devolvidos"})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[{key:"varejo",label:"Varejo",colorClass:"text-blue-700",valueClass:"text-blue-600"},{key:"franquias",label:"Franquias",colorClass:"text-yellow-700",valueClass:"text-yellow-600"},{key:"mtm",label:"Multimarcas",colorClass:"text-green-700",valueClass:"text-green-600"},{key:"revenda",label:"Revenda",colorClass:"text-purple-700",valueClass:"text-purple-600"},{key:"bazar",label:"Bazar",colorClass:"text-purple-700",valueClass:"text-purple-600"},{key:"sellect",label:"Sellect",colorClass:"text-cyan-700",valueClass:"text-cyan-600"}].map(s=>{var d,n;const l=(((d=o[s.key])==null?void 0:d.valor_liquido_saida)||0)-Math.abs(((n=o[s.key])==null?void 0:n.valor_liquido_entrada)||0),e=m(l),t=Z(s.key);if(t.anterior<0)return a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsx(p,{className:`text-sm font-bold ${s.colorClass}`,children:s.label})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:`text-base font-extrabold ${s.valueClass} mb-0.5`,children:e}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Per√≠odo anterior: ",m(t.anterior)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsxs("span",{className:"font-bold text-green-600 text-lg",children:["+",Math.abs(t.variacao).toFixed(2),"%"]}),a.jsx("span",{className:"text-xs text-gray-500",children:"vs. m√™s anterior"})]})]})]},s.key);const r=t.variacao!==null&&t.variacao>=0;return a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsx(_,{className:"pb-2",children:a.jsx(p,{className:`text-sm font-bold ${s.colorClass}`,children:s.label})}),a.jsxs(f,{className:"pt-0 px-4 pb-4",children:[a.jsx("div",{className:`text-base font-extrabold ${s.valueClass} mb-0.5`,children:e}),a.jsxs("div",{className:"text-xs text-gray-500",children:["Per√≠odo anterior: ",m(t.anterior)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsxs("span",{className:`font-bold ${r?"text-green-600":"text-red-600"} text-lg`,children:[r?"+":"",t.variacao!==null?t.variacao.toFixed(1)+"%":"‚Äî"]}),a.jsx("span",{className:"text-xs text-gray-500",children:"vs. m√™s anterior"})]})]})]},s.key)})}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Object.keys(o).filter(s=>s!=="totais").map(s=>{var l,e,t,r,d,n,i,c;return a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white",children:[a.jsxs(_,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ja,{size:20,className:"text-[#000638]"}),a.jsx(p,{className:"text-lg font-bold text-[#000638]",children:s.charAt(0).toUpperCase()+s.slice(1)})]}),a.jsxs(N,{children:["Resumo financeiro do canal ",s]})]}),a.jsx(f,{className:"bg-white",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"border-b pb-2",children:[a.jsx("div",{className:"flex justify-between items-center mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-blue-700",children:"VENDAS (SA√çDA)"})}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Valor Bruto:"}),a.jsx("span",{className:"font-bold text-blue-600 text-sm",children:m((l=o[s])==null?void 0:l.valor_bruto_saida)})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Valor L√≠quido:"}),a.jsx("span",{className:"font-bold text-green-600 text-sm",children:m((e=o[s])==null?void 0:e.valor_liquido_saida)})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Descontos:"}),a.jsx("span",{className:"font-bold text-orange-600 text-sm",children:m((t=o[s])==null?void 0:t.desconto_saida)})]})]}),a.jsxs("div",{className:"border-b pb-2",children:[a.jsx("div",{className:"flex justify-between items-center mb-1",children:a.jsx("span",{className:"text-sm font-semibold text-red-700",children:"DEVOLU√á√ïES (ENTRADA)"})}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Valor Bruto:"}),a.jsx("span",{className:"font-bold text-red-600 text-sm",children:m(Math.abs((r=o[s])==null?void 0:r.valor_bruto_entrada))})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Valor L√≠quido:"}),a.jsx("span",{className:"font-bold text-red-500 text-sm",children:m(Math.abs((d=o[s])==null?void 0:d.valor_liquido_entrada))})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Descontos:"}),a.jsx("span",{className:"font-bold text-orange-600 text-sm",children:m(Math.abs((n=o[s])==null?void 0:n.desconto_entrada))})]})]}),a.jsxs("div",{className:"border-t pt-2",children:[a.jsx("div",{className:"flex justify-between items-center mb-1",children:a.jsx("span",{className:"text-sm font-bold text-gray-800",children:"TOTAL GERAL"})}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Receita L√≠quida:"}),a.jsx("span",{className:"font-bold text-green-600 text-lg",children:m((((i=o[s])==null?void 0:i.valor_liquido_saida)||0)-Math.abs(((c=o[s])==null?void 0:c.valor_liquido_entrada)||0))})]})]})]})})]},s)})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6 mt-10",children:[a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white cursor-pointer",onClick:()=>B({tipo:"distribuicao",title:"Distribui√ß√£o do Faturamento por Canal",data:D}),children:[a.jsxs(_,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{size:20,className:"text-[#000638]"}),a.jsx(p,{className:"text-lg font-bold text-[#000638]",children:"Distribui√ß√£o do Faturamento por Canal"})]}),a.jsx(N,{children:"Percentual de participa√ß√£o de cada canal no faturamento total"})]}),a.jsx(f,{children:a.jsx("div",{className:"h-80 bg-white rounded",children:D&&D.labels&&D.labels.length>0?a.jsx(I,{data:D,options:P}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Sem dados para exibir"})})})]}),a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white p-6 min-h-[420px] flex flex-col justify-center items-center cursor-pointer",onClick:()=>B({tipo:"devolucao",title:"Frequ√™ncia de Devolu√ß√µes por Canal",data:A}),children:[a.jsxs(_,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{size:20,className:"text-[#000638]"}),a.jsx(p,{className:"text-lg font-bold text-[#000638]",children:"Frequ√™ncia de Devolu√ß√µes por Canal"})]}),a.jsx(N,{children:"Veja qual canal tem maior frequ√™ncia de devolu√ß√µes"})]}),a.jsx(f,{children:a.jsx("div",{className:"h-[320px] w-full flex items-center justify-center",children:A&&A.labels&&A.labels.length>0?a.jsx(I,{data:A,options:P}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Sem dados para exibir"})})})]})]}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6 mt-10",children:["varejo","mtm","franquias","revenda"].map(s=>{const l=F[s]||[],e=new Map;l.forEach(c=>{const x=c.cd_grupoempresa||c.cd_empresa,g=c.nm_grupoempresa||c.cd_grupoempresa||`Empresa ${c.cd_empresa}`,j=parseFloat(c.valor_com_desconto_saida)||0,y=parseFloat(c.valor_com_desconto_entrada)||0,q=j-Math.abs(y);e.has(x)?e.get(x).valor+=q:e.set(x,{nome:g,valor:q})});const t=Array.from(e.values()),r=t.length>0?t.map(c=>c.nome):["Sem dados"],d=t.length>0?t.map(c=>c.valor):[0],n={labels:r,datasets:[{data:d,backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#6366F1","#F472B6","#F87171","#34D399","#A78BFA","#FBBF24","#6EE7B7","#F9A8D4","#FDE68A","#C7D2FE","#FCA5A5","#A3E635","#FCD34D","#818CF8","#FECACA","#F3F4F6"],borderWidth:2,borderColor:"#fff"}]},i={varejo:"Varejo",mtm:"Multimarcas",franquias:"Franquias",revenda:"Revenda"}[s];return a.jsxs(h,{className:"shadow-lg transition-all duration-200 hover:shadow-xl hover:-translate-y-1 rounded-xl bg-white cursor-pointer",onClick:()=>B({canal:s,pizzaData:n,canalLabel:i}),children:[a.jsxs(_,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{size:20,className:"text-[#000638]"}),a.jsxs(p,{className:"text-lg font-bold text-[#000638]",children:[i," - Faturamento por Empresa"]})]}),a.jsxs(N,{children:["Distribui√ß√£o do faturamento por empresa (",i,")"]})]}),a.jsx(f,{children:a.jsx("div",{className:"h-80 bg-white rounded",children:n&&n.labels&&n.labels.length>0?a.jsx(I,{data:n,options:P}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Sem dados para exibir"})})})]},s)})}),v&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-3xl w-full flex flex-col items-center relative",children:[a.jsx("button",{onClick:()=>B(null),className:"absolute top-4 right-4 text-gray-500 hover:text-red-600 text-2xl font-bold","aria-label":"Fechar",children:"√ó"}),a.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[a.jsx(O,{size:28,className:"text-[#000638]"}),a.jsx("span",{className:"text-2xl font-bold text-[#000638]",children:v.title||v.canalLabel&&`${v.canalLabel} - Faturamento por Empresa`})]}),a.jsx("div",{className:"w-full flex items-center justify-center",style:{height:"480px"},children:v.data&&v.data.labels&&v.data.labels.length>0||v.pizzaData&&v.pizzaData.labels&&v.pizzaData.labels.length>0?a.jsx(I,{data:v.data||v.pizzaData,options:P}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"Sem dados para exibir"})})]})})]}):a.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:a.jsxs("div",{className:"bg-gray-50 rounded-xl p-8 max-w-md",children:[a.jsx(H,{size:48,className:"text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Nenhum dado encontrado"}),a.jsx("p",{className:"text-gray-500 text-sm mb-4",children:'Selecione um per√≠odo e clique em "Buscar Dados" para visualizar o dashboard de faturamento.'})]})})]})};export{Wa as default};
