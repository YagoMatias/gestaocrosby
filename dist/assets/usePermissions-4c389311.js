import{u as $,r as t,K,M as L,N as M,O as N,Q,T,V,W as X,X as Y,Y as Z,Z as j}from"./index-a2563983.js";const z=()=>{const{user:u}=$(),[E,o]=t.useState(!1),[g,a]=t.useState(null),[d,f]=t.useState([]),[c,y]=t.useState(null),[w,i]=t.useState([]),h=t.useCallback(async()=>{o(!0),a(null);try{const{data:r,error:s}=await K();if(s)throw s;f(r||[])}catch(r){console.error("Erro ao carregar usuários:",r),a(r.message||"Erro ao carregar usuários")}finally{o(!1)}},[]),p=t.useCallback(async()=>{o(!0),a(null);try{const{data:r,error:s}=await L();if(s)throw s;f(r||[])}catch(r){console.error("Erro ao carregar usuários com permissões:",r),a(r.message||"Erro ao carregar usuários com permissões")}finally{o(!1)}},[]),m=t.useCallback(async r=>{o(!0),a(null);try{const{data:s,error:e}=await M(r);if(e)throw e;return i(s||[]),s||[]}catch(s){return console.error("Erro ao carregar permissões do usuário:",s),a(s.message||"Erro ao carregar permissões"),[]}finally{o(!1)}},[]),P=t.useCallback(async(r,s)=>{o(!0),a(null);try{const{data:e,error:n}=await N(r,s);if(n)throw n;return(c==null?void 0:c.id)===r&&i(s),{success:!0,error:null}}catch(e){return console.error("Erro ao salvar permissões:",e),a(e.message||"Erro ao salvar permissões"),{success:!1,error:e.message}}finally{o(!1)}},[c]),k=t.useCallback(async(r,s)=>{o(!0),a(null);try{const{data:e,error:n}=await Q(r,s);if(n)throw n;return{success:!0,error:null}}catch(e){return console.error("Erro ao salvar permissões em massa:",e),a(e.message||"Erro ao salvar permissões em massa"),{success:!1,error:e.message}}finally{o(!1)}},[]),v=t.useCallback(async(r,s)=>{o(!0),a(null);try{const{data:e,error:n}=await T(r,s);if(n)throw n;return(c==null?void 0:c.id)===r&&i(l=>l.filter(O=>O!==s)),{success:!0,error:null}}catch(e){return console.error("Erro ao remover permissão:",e),a(e.message||"Erro ao remover permissão"),{success:!1,error:e.message}}finally{o(!1)}},[c]),C=t.useCallback(async(r,s)=>{o(!0),a(null);try{const{data:e,error:n}=await V(r,s);if(n)throw n;return(c==null?void 0:c.id)===r&&i(l=>l.includes(s)?l:[...l,s]),{success:!0,error:null}}catch(e){return console.error("Erro ao adicionar permissão:",e),a(e.message||"Erro ao adicionar permissão"),{success:!1,error:e.message}}finally{o(!1)}},[c]),b=t.useCallback(async r=>{o(!0),a(null);try{const{data:s,error:e}=await X(r);if(e)throw e;return(c==null?void 0:c.id)===r&&i([]),{success:!0,error:null}}catch(s){return console.error("Erro ao limpar permissões:",s),a(s.message||"Erro ao limpar permissões"),{success:!1,error:s.message}}finally{o(!1)}},[c]),U=t.useCallback(async(r,s)=>{o(!0),a(null);try{const{data:e,error:n}=await Y(r,s);if(n)throw n;return{success:!0,error:null}}catch(e){return console.error("Erro ao copiar permissões:",e),a(e.message||"Erro ao copiar permissões"),{success:!1,error:e.message}}finally{o(!1)}},[]),S=t.useCallback(async(r,s)=>{try{const{data:e,error:n}=await Z(r,s);if(n)throw n;return e}catch(e){return console.error("Erro ao verificar permissão:",e),!1}},[]),B=t.useCallback(async()=>{try{const{data:r,error:s}=await j();if(s)throw s;return r}catch(r){return console.error("Erro ao buscar contagem de permissões:",r),{}}},[]),A=t.useCallback(async r=>{y(r),r?await m(r.id):i([])},[m]),W=t.useCallback(()=>{y(null),i([])},[]),x=(u==null?void 0:u.role)==="owner";return{loading:E,error:g,users:d,selectedUser:c,userPermissions:w,isOwner:x,loadUsers:h,loadUsersWithPermissions:p,loadUserPermissions:m,savePermissions:P,saveBulkPermissions:k,addPermission:C,removePermission:v,clearPermissions:b,copyPermissions:U,checkPermission:S,getPermissionsCount:B,selectUser:A,clearSelection:W,setError:a}};export{z as u};
